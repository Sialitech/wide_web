"use strict";(self.webpackChunkClearML_webapp=self.webpackChunkClearML_webapp||[]).push([[175],{66175:function(e,t,n){n.r(t),n.d(t,{WorkersAndQueuesModule:function(){return is}});var s=n(1707),i=n(54364),r=n(95682),o=n(9170),a=n(53466),u=n(74400);const l=(0,u.PH)("QUEUES_GET_QUEUES"),c=(0,u.PH)("QUEUES_SET_QUEUES",(0,u.Ky)()),d=(0,u.PH)("QUEUES_QUEUES_TABLE_SORT_CHANGED",(0,u.Ky)()),p=(0,u.PH)("QUEUES_QUEUES_TABLE_SET_SORT",(0,u.Ky)()),h=(0,u.PH)("QUEUES_SET_SELECTED_QUEUE",(0,u.Ky)()),m=(0,u.PH)("QUEUES_REFRESH_SELECTED_QUEUE"),g=(0,u.PH)("QUEUES_SET_SELECTED_QUEUE_FROM_SERVER",(0,u.Ky)()),_=(0,u.PH)("QUEUES_SYNC_SPECIFIC_QUEUE_IN_TABLE",(0,u.Ky)()),f=(0,u.PH)("QUEUES_DELETE_QUEUE",(0,u.Ky)()),U=(0,u.PH)("QUEUES_MOVE_EXPERIMENT_TO_BOTTOM_OF_QUEUE",(0,u.Ky)()),v=(0,u.PH)("QUEUES_MOVE_EXPERIMENT_TO_TOP_OF_QUEUE",(0,u.Ky)()),x=(0,u.PH)("QUEUES_MOVE_EXPERIMENT_IN_QUEUE",(0,u.Ky)()),E=(0,u.PH)("QUEUES_REMOVE_EXPERIMENT_FROM_QUEUE",(0,u.Ky)()),T=(0,u.PH)("QUEUES_MOVE_EXPERIMENT_TO_OTHER_QUEUE",(0,u.Ky)()),w=(0,u.PH)("QUEUES_ADD_EXPERIMENT_TO_QUEUE",(0,u.Ky)()),b=(0,u.PH)("QUEUES_GET_STATS",(0,u.Ky)()),k=(0,u.PH)("QUEUES_SET_STATS",(0,u.Ky)()),O=(0,u.PH)("QUEUES_SET_STATS_PARAMS",(0,u.Ky)()),Q="CREATE_QUEUE_DIALOG_",C={GET_QUEUES:Q+"GET_QUEUES",SET_QUEUES:Q+"SET_QUEUES",RESET_STATE:Q+"RESET_STATE",CREATE_NEW_QUEUE:Q+"CREATE_NEW_QUEUE",UPDATE_QUEUE:Q+"UPDATE_QUEUE",SET_CREATION_STATUS:Q+"SET_CREATION_STATUS"};class q{constructor(){this.type=C.GET_QUEUES}}class y{constructor(e){this.type=C.SET_QUEUES,this.payload={queues:e}}}class M{constructor(){this.type=C.RESET_STATE}}class A{constructor(e){this.payload=e,this.type=C.CREATE_NEW_QUEUE}}class Z{constructor(e){this.payload=e,this.type=C.UPDATE_QUEUE}}class S{constructor(e){this.type=C.SET_CREATION_STATUS,this.payload={creationStatus:e}}}const P={queues:[],creationStatus:null},I=(0,u.ZF)("queueCreateDialog"),N=(0,u.P1)(I,e=>e.queues),D=(0,u.P1)(I,e=>e.creationStatus);function R(e=P,t){switch(t.type){case C.SET_CREATION_STATUS:return Object.assign(Object.assign({},e),{creationStatus:t.payload.creationStatus});case C.SET_QUEUES:return Object.assign(Object.assign({},e),{queues:t.payload.queues});case C.RESET_STATE:return Object.assign({},P);default:return e}}var F=n(22213),J=n(2316),W=n(91578),L=n(65788),H=n(55519),j=n(29780);const B=["queueForm"];function Y(e,t){1&e&&(J.TgZ(0,"mat-error"),J._uU(1,"Required"),J.qZA())}function z(e,t){1&e&&(J.TgZ(0,"mat-error"),J._uU(1,"Name should contain at least 3 characters"),J.qZA())}function G(e,t){1&e&&(J.TgZ(0,"mat-error"),J._uU(1,"Name should be unique"),J.qZA())}let K=(()=>{class e{constructor(){this.queue={name:null,id:null},this.queueCreated=new J.vpe}set queues(e){this.queuesNames=e.map(e=>e.name)}get isEdit(){return!!this.queue.id}send(){this.queueForm.valid?this.queueCreated.emit(this.queue):this.queueForm.onSubmit(null)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=J.Xpm({type:e,selectors:[["sm-create-new-queue-form"]],viewQuery:function(e,t){if(1&e&&J.Gf(B,7),2&e){let e;J.iGM(e=J.CRH())&&(t.queueForm=e.first)}},inputs:{queues:"queues",queue:"queue"},outputs:{queueCreated:"queueCreated"},decls:33,vars:7,consts:[[1,"create-queue-form"],["queueForm","ngForm"],[1,"row","position-relative"],["appearance","outline",1,"w-100","pt-3"],[4,"ngIf"],["matInput","","type","text","name","queueName","required","","minlength","3","smUniqueNameValidator","",3,"ngModel","existingNames","ngModelChange"],["name","ngModel"],[1,"row"],[1,"col-24","create-queue-button"],[1,"btn","btn-dark-fill","center",3,"disabled","click"]],template:function(e,t){if(1&e&&(J.TgZ(0,"ng-form",0,1),J._uU(2,"\n  "),J.TgZ(3,"div",2),J._uU(4,"\n    "),J.TgZ(5,"mat-form-field",3),J._uU(6,"\n      "),J.YNc(7,Y,2,0,"mat-error",4),J._uU(8,"\n      "),J.YNc(9,z,2,0,"mat-error",4),J._uU(10,"\n      "),J.YNc(11,G,2,0,"mat-error",4),J._uU(12,"\n      "),J.TgZ(13,"mat-label"),J._uU(14,"Queue name"),J.qZA(),J._uU(15,"\n      "),J.TgZ(16,"input",5,6),J.NdJ("ngModelChange",function(e){return t.queue.name=e}),J.qZA(),J._uU(18,"\n    "),J.qZA(),J._uU(19,"\n  "),J.qZA(),J._uU(20,"\n  "),J._UZ(21,"br"),J._uU(22,"\n  "),J.TgZ(23,"div",7),J._uU(24,"\n    "),J.TgZ(25,"div",8),J._uU(26,"\n      "),J.TgZ(27,"button",9),J.NdJ("click",function(){return t.send()}),J._uU(28),J.qZA(),J._uU(29,"\n    "),J.qZA(),J._uU(30,"\n  "),J.qZA(),J._uU(31,"\n"),J.qZA(),J._uU(32,"\n")),2&e){const e=J.MAs(1),n=J.MAs(17);J.xp6(7),J.Q6J("ngIf",null==n||null==n.errors?null:n.errors.required),J.xp6(2),J.Q6J("ngIf",null==n||null==n.errors?null:n.errors.minlength),J.xp6(2),J.Q6J("ngIf",null==n||null==n.errors?null:n.errors.uniqueName),J.xp6(5),J.Q6J("ngModel",t.queue.name)("existingNames",t.queuesNames),J.xp6(11),J.Q6J("disabled",e.invalid),J.xp6(1),J.hij("",t.isEdit?"RENAME":"CREATE","\n      ")}},directives:[s.F,L.KE,i.O5,L.hX,H.Nt,s.Fj,s.Q7,s.wO,j.i,s.JJ,s.On,L.TO],styles:["[_nghost-%COMP%]   .create-queue-form[_ngcontent-%COMP%]{width:400px;display:block}[_nghost-%COMP%]   .create-queue-button[_ngcontent-%COMP%]{padding-top:32px}[_nghost-%COMP%]   small.text-danger[_ngcontent-%COMP%]{position:absolute!important;top:-15px}[_nghost-%COMP%]   #queue-description[_ngcontent-%COMP%]{max-height:250px}"]}),e})(),$=(()=>{class e{constructor(e,t,n){this.store=e,this.matDialogRef=t,this.data=n,this.editMode=!1,this.queue={name:null,id:null},n&&(this.queue=n,this.editMode=!0),this.queues$=this.store.select(N)}ngOnInit(){this.store.dispatch(new q),this.creationStatusSubscription=this.store.select(D).subscribe(e=>{if("success"===e)return this.matDialogRef.close(!0)})}ngOnDestroy(){this.store.dispatch(new M),this.creationStatusSubscription.unsubscribe()}createQueue(e){this.store.dispatch(e.id?new Z({queue:e.id,name:e.name}):new A(e))}}return e.\u0275fac=function(t){return new(t||e)(J.Y36(u.yh),J.Y36(F.so),J.Y36(F.WI))},e.\u0275cmp=J.Xpm({type:e,selectors:[["sm-queue-create-dialog"]],decls:7,vars:5,consts:[["iconClass","al-icon al-ico-queues",3,"header"],[3,"queues","queue","queueCreated"]],template:function(e,t){1&e&&(J.TgZ(0,"sm-dialog-template",0),J._uU(1,"\n  "),J.TgZ(2,"sm-create-new-queue-form",1),J.NdJ("queueCreated",function(e){return t.createQueue(e)}),J.ALo(3,"async"),J._uU(4,"\n  "),J.qZA(),J._uU(5,"\n"),J.qZA(),J._uU(6,"\n")),2&e&&(J.Q6J("header",t.queue.id?"RENAME QUEUE":"NEW QUEUE"),J.xp6(2),J.Q6J("queues",J.lcZ(3,3,t.queues$))("queue",t.queue))},directives:[W._,K],pipes:[i.Ov],styles:[""]}),e})();var X=n(82027);function V(e,t){if(1&e){const e=J.EpF();J.TgZ(0,"button",10),J.NdJ("click",function(){return J.CHM(e),J.oxw(2).addQueue()}),J._uU(1,"\n        "),J._UZ(2,"i",11),J._uU(3,"\n        "),J.TgZ(4,"span"),J._uU(5," \xa0 NEW QUEUE"),J.qZA(),J._uU(6,"\n      "),J.qZA()}}function ee(e,t){if(1&e&&(J.TgZ(0,"div"),J._uU(1,"\n      "),J.YNc(2,V,7,0,"button",9),J._uU(3,"\n    "),J.qZA()),2&e){const e=J.oxw();J.xp6(2),J.Q6J("ngIf",e.queuesManager)}}const te=function(){return["workers"]},ne=function(){return["queues"]};let se=(()=>{class e{constructor(e,t,n){this.dialog=e,this.store=t,this.route=n,this.queuesManager=n.snapshot.data.queuesManager}addQueue(){this.createQueueDialog=this.dialog.open($),this.createQueueDialog.afterClosed().pipe((0,o.h)(e=>!!e),(0,a.q)(1)).subscribe(e=>{this.store.dispatch(l())})}}return e.\u0275fac=function(t){return new(t||e)(J.Y36(F.uw),J.Y36(u.yh),J.Y36(r.gz))},e.\u0275cmp=J.Xpm({type:e,selectors:[["sm-workers-and-queues"]],decls:27,vars:7,consts:[[1,"navbar-header-container"],[1,"d-flex","justify-content-between","header-container","align-items-center"],[1,"nav-bar-items-container"],["routerLinkActive","",3,"routerLink"],["rlaWorkers","routerLinkActive"],["direction","top","header","workers",3,"active"],["rlaQueues","routerLinkActive"],["direction","top","header","queues",3,"active"],[4,"ngIf"],["class","btn btn-primary d-flex align-items-center",3,"click",4,"ngIf"],[1,"btn","btn-primary","d-flex","align-items-center",3,"click"],[1,"al-icon","al-ico-add","sm"]],template:function(e,t){if(1&e&&(J.TgZ(0,"div",0),J._uU(1,"\n  "),J.TgZ(2,"div",1),J._uU(3,"\n    "),J._UZ(4,"div"),J._uU(5,"\n    "),J.TgZ(6,"div",2),J._uU(7,"\n      "),J.TgZ(8,"span",3,4),J._uU(10,"\n        "),J._UZ(11,"sm-navbar-item",5),J._uU(12,"\n      "),J.qZA(),J._uU(13,"\n      "),J.TgZ(14,"span",3,6),J._uU(16,"\n        "),J._UZ(17,"sm-navbar-item",7),J._uU(18,"\n      "),J.qZA(),J._uU(19,"\n    "),J.qZA(),J._uU(20,"\n    "),J.YNc(21,ee,4,1,"div",8),J._uU(22,"\n  "),J.qZA(),J._uU(23,"\n"),J.qZA(),J._uU(24,"\n"),J._UZ(25,"router-outlet"),J._uU(26,"\n")),2&e){const e=J.MAs(9),t=J.MAs(15);J.xp6(8),J.Q6J("routerLink",J.DdM(5,te)),J.xp6(3),J.Q6J("active",e.isActive),J.xp6(3),J.Q6J("routerLink",J.DdM(6,ne)),J.xp6(3),J.Q6J("active",t.isActive),J.xp6(4),J.Q6J("ngIf",t.isActive)}},directives:[r.Od,r.rH,X.f,i.O5,r.lC],styles:["[_nghost-%COMP%]   .navbar-header-container[_ngcontent-%COMP%]{min-height:64px}[_nghost-%COMP%]   .navbar-header-container[_ngcontent-%COMP%]   .nav-bar-items-container[_ngcontent-%COMP%]{position:absolute;left:50%;transform:translate(-50%)}[_nghost-%COMP%]   .navbar-header-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]{padding-left:24px;padding-right:24px;height:66px;transition:background-color .5s}[_nghost-%COMP%]   .navbar-header-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]     button{border-color:#2c3246;box-shadow:none}"]}),e})();const ie="WORKERS_",re=(0,u.PH)(ie+"[get workers and stats]",(0,u.Ky)()),oe=(0,u.PH)(ie+"[set workers]",(0,u.Ky)()),ae=(0,u.PH)(ie+"[get selected worker]",(0,u.Ky)()),ue=(0,u.PH)(ie+"[set selected worker]",(0,u.Ky)()),le=(0,u.PH)(ie+"[table sort changed]",(0,u.Ky)()),ce=(0,u.PH)(ie+"[set table sort]",(0,u.Ky)()),de=(0,u.PH)(ie+"[set stats]",(0,u.Ky)()),pe=(0,u.PH)(ie+"[set stats parameters]",(0,u.Ky)()),he={ID:"id",NAME:"name",USER:"user.name",QUEUED:"status_changed",TASK:"entries[0].task.name",IN_QUEUE:"entries.length",LAST_UPDATED:"last_update"},me={ID:"id",TASK:"task.name",TASK_RUNNING_TIME:"task.running_time",TASK_ITERATIONS:"task.last_iteration"},ge=1048576,_e={cpu_usage:{title:"CPU Usage",multiply:1},gpu_usage:{title:"GPU Usage",multiply:1},memory_used:{title:"Memory Used",multiply:ge},gpu_memory_used:{title:"GPU Memory",multiply:ge},network_rx:{title:"Network Receive",multiply:ge},network_tx:{title:"Network Transmit",multiply:ge}},fe={HOUR:3600,DAY:86400,WEEK:604800,MONTH:2592e3,YEAR:31536e3};var Ue=n(85312);const ve={data:null,selectedQueue:null,tasks:null,stats:{wait:null,length:null},selectedStatsTimeFrame:(3*fe.HOUR).toString(),tableSortFields:[{field:he.NAME,order:Ue.BS.ASC}]},xe={data:null,selectedWorker:null,stats:null,selectedStatsTimeFrame:(3*fe.HOUR).toString(),selectedStatsParam:"cpu_usage;gpu_usage",tableSortFields:[{field:"id",order:Ue.BS.ASC}]},Ee=(0,u.Lq)(xe,(0,u.on)(oe,(e,t)=>Object.assign(Object.assign({},e),{data:t.workers})),(0,u.on)(ue,ae,(e,t)=>Object.assign(Object.assign({},e),{selectedWorker:t.worker})),(0,u.on)(ce,(e,t)=>Object.assign(Object.assign({},e),{tableSortFields:t.orders})),(0,u.on)(re,(e,t)=>Object.assign(Object.assign({},e),{statsRequest:t})),(0,u.on)(de,(e,t)=>Object.assign(Object.assign({},e),{stats:t.data})),(0,u.on)(pe,(e,t)=>Object.assign(Object.assign({},e),{selectedStatsTimeFrame:t.timeFrame,selectedStatsParam:t.param}))),Te=(0,u.PH)("stats SHOW_STATS_ERROR"),we=(0,u.PH)("stats HIDE_STATS_ERROR"),be=(0,u.Lq)({showNoStatsNotice:!1},(0,u.on)(Te,e=>Object.assign(Object.assign({},e),{showNoStatsNotice:!0})),(0,u.on)(we,e=>Object.assign(Object.assign({},e),{showNoStatsNotice:!1}))),ke={workers:Ee,queues:function(e=ve,t){switch(t.type){case c.type:return Object.assign(Object.assign({},e),{data:t.queues});case h.type:case g.type:return Object.assign(Object.assign({},e),{selectedQueue:t.queue});case _.type:return Object.assign(Object.assign({},e),{data:e.data.map(e=>{var n;return e.id===(null===(n=t.queue)||void 0===n?void 0:n.id)?t.queue:e})});case k.type:return Object.assign(Object.assign({},e),{stats:t.data});case p.type:return Object.assign(Object.assign({},e),{tableSortFields:t.orders});case O.type:return Object.assign(Object.assign({},e),{selectedStatsTimeFrame:t.timeFrame});default:return e}},stats:function(e,t){return be(e,t)}},Oe=(0,u.ZF)("workersAndQueues"),Qe=(0,u.P1)(Oe,e=>e.queues),Ce=(0,u.P1)(Qe,e=>e.data),qe=(0,u.P1)(Qe,e=>e.selectedQueue),ye=(0,u.P1)(Qe,e=>e.tasks),Me=(0,u.P1)(Qe,e=>e.stats),Ae=(0,u.P1)(Qe,e=>e.selectedStatsTimeFrame),Ze=(0,u.P1)(Qe,e=>e.tableSortFields),Se=(0,u.P1)(Oe,e=>e.workers),Pe=(0,u.P1)(Se,e=>e.data),Ie=(0,u.P1)(Se,e=>e.stats),Ne=((0,u.P1)(Se,e=>e.statsRequest),(0,u.P1)(Se,e=>e.selectedWorker)),De=(0,u.P1)(Se,e=>e.tableSortFields),Re=(0,u.P1)(Se,e=>e.selectedStatsParam),Fe=(0,u.P1)(Se,e=>e.selectedStatsTimeFrame),Je=(0,u.P1)(Oe,e=>e.stats),We=(0,u.P1)(Je,e=>e.showNoStatsNotice);var Le=n(17163),He=n(61486),je=n(68921),Be=n(37007),Ye=n(93223),ze=n(24298),Ge=n(38794);const Ke=["chart"];function $e(e,t){1&e&&(J.TgZ(0,"div",12),J._uU(1,"Workers Utilization"),J.qZA())}function Xe(e,t){if(1&e&&(J.TgZ(0,"mat-option",15),J._uU(1),J.qZA()),2&e){const e=t.$implicit;J.Q6J("value",e.value),J.xp6(1),J.hij("\n            ",e.label,"\n          ")}}function Ve(e,t){if(1&e){const e=J.EpF();J.TgZ(0,"div",13),J._uU(1,"\n      "),J.TgZ(2,"mat-form-field",6),J._uU(3,"\n        "),J.TgZ(4,"mat-select",14),J.NdJ("ngModelChange",function(t){return J.CHM(e),J.oxw().chartParamChange(t)}),J._uU(5,"\n          "),J.YNc(6,Xe,2,2,"mat-option",8),J._uU(7,"\n        "),J.qZA(),J._uU(8,"\n      "),J.qZA(),J._uU(9,"\n    "),J.qZA()}if(2&e){const e=J.oxw();J.xp6(4),J.Q6J("ngModel",e.currentParam),J.xp6(2),J.Q6J("ngForOf",e.chartParamOptions)}}function et(e,t){1&e&&(J.TgZ(0,"i",16),J._uU(1,"\n    "),J.qZA())}function tt(e,t){if(1&e&&(J.TgZ(0,"mat-option",15),J._uU(1),J.qZA()),2&e){const e=t.$implicit;J.Q6J("value",e.value),J.xp6(1),J.hij("\n          ",e.label,"\n        ")}}let nt=(()=>{class e{constructor(e){this.store=e,this.statsError$=this.store.select(We),this.refreshChart=!0,this.timeFrameOptions=[{label:"3 Hours",value:(3*fe.HOUR).toString()},{label:"6 Hours",value:(6*fe.HOUR).toString()},{label:"12 Hours",value:(12*fe.HOUR).toString()},{label:"1 Day",value:fe.DAY.toString()},{label:"1 Week",value:fe.WEEK.toString()},{label:"1 Month",value:fe.MONTH.toString()}],this.chartParamOptions=[{label:"CPU and GPU Usage",value:"cpu_usage;gpu_usage"},{label:"Memory Usage",value:"memory_used"},{label:"Video Memory",value:"gpu_memory_used"},{label:"Network Usage",value:"network_rx;network_tx"}],this.yAxisLabels={"cpu_usage;gpu_usage":"Usage %",memory_used:"Bytes",gpu_memory_used:"Bytes","network_rx;network_tx":"Bytes/sec"}}set worker(e){(0,je.get)("id",this.activeWorker)!==(0,je.get)("id",e)&&(this.activeWorker=e,e&&(this.yAxisLabel=this.yAxisLabels[this.currentParam]),this.chartChanged())}ngOnInit(){this.chartParamSubscription=(0,He.aj)([this.store.select(Fe),this.store.select(Re)]).pipe((0,o.h)(([e,t])=>!!e&&!!t)).subscribe(([e,t])=>{this.currentParam=t,this.currentTimeFrame=e,this.yAxisLabel=this.activeWorker?this.yAxisLabels[t]:"Count",this.chartChanged()}),this.chartDataSubscription=this.store.select(Ie).subscribe(e=>{e&&(this.refreshChart=!1,this.chartData={dataByTopic:e})}),this.chartChanged()}ngOnDestroy(){this.chartDataSubscription.unsubscribe(),this.chartParamSubscription.unsubscribe(),clearInterval(this.intervaleHandle)}chartChanged(){const e=parseInt(this.currentTimeFrame,10);clearInterval(this.intervaleHandle),this.refreshChart=!0;let t=this.chartRef.element.nativeElement.clientWidth||1e3;t=Math.min(.8*t,1e3);const n=Math.max(Math.floor(e/t),this.activeWorker?10:40);this.store.dispatch(de({data:null})),this.store.dispatch(re({maxPoints:t})),this.intervaleHandle=window.setInterval(()=>{this.store.dispatch(re({maxPoints:t}))},1e3*n)}chartParamChange(e){this.currentParam=e,this.store.dispatch(pe({timeFrame:this.currentTimeFrame,param:this.currentParam}))}timeFrameChange(e){this.currentTimeFrame=e,this.store.dispatch(pe({timeFrame:this.currentTimeFrame,param:this.currentParam}))}}return e.\u0275fac=function(t){return new(t||e)(J.Y36(u.yh))},e.\u0275cmp=J.Xpm({type:e,selectors:[["sm-workers-graph"]],viewQuery:function(e,t){if(1&e&&J.Gf(Ke,7,J.s_b),2&e){let e;J.iGM(e=J.CRH())&&(t.chartRef=e.first)}},inputs:{worker:"worker"},decls:30,vars:11,consts:[[1,"header","d-flex","justify-content-between"],[1,"d-flex","align-items-center"],["class","title",4,"ngIf"],["class","param-selector",4,"ngIf"],["class","warnning fas fa-exclamation-triangle","smTooltip","Data temporarily not available",4,"ngIf"],[1,"time-selector"],["appearance","outline",1,"dark-outline","thin","time-selector"],["name","time-frame","panelClass","dark-outline",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"line-chart-container"],["chart",""],[1,"h-100",3,"showLoadingOverlay","data","yLabel","tooltipVerticalOffset"],[1,"title"],[1,"param-selector"],["name","chart-param","panelClass","dark-outline",3,"ngModel","ngModelChange"],[3,"value"],["smTooltip","Data temporarily not available",1,"warnning","fas","fa-exclamation-triangle"]],template:function(e,t){1&e&&(J.TgZ(0,"div",0),J._uU(1,"\n  "),J.TgZ(2,"div",1),J._uU(3,"\n    "),J.YNc(4,$e,2,0,"div",2),J._uU(5,"\n    "),J.YNc(6,Ve,10,2,"div",3),J._uU(7,"\n    "),J.YNc(8,et,2,0,"i",4),J.ALo(9,"async"),J._uU(10,"\n  "),J.qZA(),J._uU(11,"\n  "),J.TgZ(12,"div",5),J._uU(13,"\n    "),J.TgZ(14,"mat-form-field",6),J._uU(15,"\n      "),J.TgZ(16,"mat-select",7),J.NdJ("ngModelChange",function(e){return t.timeFrameChange(e)}),J._uU(17,"\n        "),J.YNc(18,tt,2,2,"mat-option",8),J._uU(19,"\n      "),J.qZA(),J._uU(20,"\n    "),J.qZA(),J._uU(21,"\n  "),J.qZA(),J._uU(22,"\n"),J.qZA(),J._uU(23,"\n"),J.TgZ(24,"div",9,10),J._uU(26,"\n  "),J._UZ(27,"sm-line-chart",11),J._uU(28,"\n"),J.qZA(),J._uU(29,"\n")),2&e&&(J.xp6(4),J.Q6J("ngIf",!t.activeWorker),J.xp6(2),J.Q6J("ngIf",t.activeWorker),J.xp6(2),J.Q6J("ngIf",J.lcZ(9,9,t.statsError$)),J.xp6(8),J.Q6J("ngModel",t.currentTimeFrame),J.xp6(2),J.Q6J("ngForOf",t.timeFrameOptions),J.xp6(9),J.Q6J("showLoadingOverlay",t.refreshChart)("data",t.chartData)("yLabel",t.yAxisLabel)("tooltipVerticalOffset",-75))},directives:[i.O5,L.KE,Be.gD,s.JJ,s.On,i.sg,Ye.D,ze.ey,Ge.i],pipes:[i.Ov],styles:["[_nghost-%COMP%]{display:block;height:364px;min-height:364px;padding:20px 20px 0;background-color:#000;border:1px solid #39405f}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]{height:48px;margin:0 30px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:15px;text-transform:uppercase}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .time-selector[_ngcontent-%COMP%], [_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .param-selector[_ngcontent-%COMP%]{width:180px;position:relative}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .warnning[_ngcontent-%COMP%]{margin-left:10px;line-height:20px;color:red}[_nghost-%COMP%]   .line-chart-container[_ngcontent-%COMP%]{height:calc(100% - 48px);position:relative;z-index:500}"]}),e})();var st=n(22330),it=n(68697),rt=n(22350),ot=n(88055),at=n(5294),ut=n(88356);const lt=["tableContainer"],ct=["table"];function dt(e,t){1&e&&(J.TgZ(0,"span"),J._uU(1,"\u2014"),J.qZA())}function pt(e,t){if(1&e&&(J.ynx(0),J._uU(1,"\n          "),J.TgZ(2,"span"),J._uU(3),J.ALo(4,"msToSec"),J.qZA(),J._uU(5,"\n          "),J.YNc(6,dt,2,0,"span",9),J._uU(7,"\n        "),J.BQk()),2&e){const e=J.oxw().rowData;J.xp6(3),J.Oqu(J.lcZ(4,2,null==e||null==e.task?null:e.task.running_time)),J.xp6(3),J.Q6J("ngIf",!(null!=e&&null!=e.task&&e.task.running_time))}}function ht(e,t){if(1&e&&(J.ynx(0),J._uU(1,"\n          "),J.TgZ(2,"span",10),J._uU(3),J.qZA(),J._uU(4,"\n        "),J.BQk()),2&e){const e=J.oxw().rowData;J.xp6(2),J.Q6J("smTooltip",e.name),J.xp6(1),J.hij("\n            ",e.name,"\n          ")}}function mt(e,t){1&e&&(J.TgZ(0,"span"),J._uU(1,"\u2014"),J.qZA())}function gt(e,t){if(1&e&&(J.ynx(0),J._uU(1),J.YNc(2,mt,2,0,"span",9),J._uU(3,"\n        "),J.BQk()),2&e){const e=J.oxw(),t=e.rowData,n=e.$implicit,s=J.oxw();J.xp6(1),J.hij("\n          ",s.getBodyData(t,n),"\n          "),J.xp6(1),J.Q6J("ngIf",0!==s.getBodyData(t,n)&&!s.getBodyData(t,n))}}function _t(e,t){if(1&e&&(J._uU(0,"\n      "),J.ynx(1,6),J._uU(2,"\n        "),J.YNc(3,pt,8,4,"ng-container",7),J._uU(4,"\n        "),J.YNc(5,ht,5,2,"ng-container",7),J._uU(6,"\n        "),J.YNc(7,gt,4,2,"ng-container",8),J._uU(8,"\n      "),J.BQk(),J._uU(9,"\n    ")),2&e){const e=t.$implicit,n=J.oxw();J.xp6(1),J.Q6J("ngSwitch",e.id),J.xp6(2),J.Q6J("ngSwitchCase",n.WORKERS_TABLE_COL_FIELDS.TASK_RUNNING_TIME),J.xp6(2),J.Q6J("ngSwitchCase",n.WORKERS_TABLE_COL_FIELDS.ID)}}function ft(e,t){if(1&e){const e=J.EpF();J._uU(0,"\n      "),J.TgZ(1,"sm-table-filter-sort-template",11),J.NdJ("sortOrderChanged",function(t){const n=J.CHM(e).$implicit;return J.oxw().onSortChanged(t,n.id)}),J._uU(2,"\n      "),J.qZA(),J._uU(3,"\n    ")}if(2&e){const e=t.$implicit,n=J.oxw();J.xp6(1),J.ekj("first",e.id===n.WORKERS_TABLE_COL_FIELDS.ID),J.Q6J("column",e)("sortOrder",n.tableSortFieldsObject[e.id])}}let Ut=(()=>{class e extends rt.E{constructor(){super(),this.WORKERS_TABLE_COL_FIELDS=me,this.workerSelected=new J.vpe,this.sortedChanged=new J.vpe,this.cols=[{id:me.ID,headerType:Ue.Ic.sortFilter,header:"AVAILABLE WORKERS",style:{width:"30%"},sortable:!0},{id:me.TASK,headerType:Ue.Ic.sortFilter,header:"CURRENTLY RUNNING EXPERIMENT",style:{width:"30%"},sortable:!0},{id:me.TASK_RUNNING_TIME,headerType:Ue.Ic.sortFilter,header:"EXPERIMENT RUNNING TIME",style:{width:"100px"},sortable:!0},{id:me.TASK_ITERATIONS,headerType:Ue.Ic.sortFilter,header:"ITERATION",style:{width:"100px"},sortable:!0}]}set workers(e){this._workers=e,this.table&&this.table.focusSelected()}get workers(){return this._workers}getBodyData(e,t){return(0,je.get)(t.id,e)}onRowClicked(e){this.workerSelected.emit(e.data)}scrollTableToTop(){this.tableContainer.nativeElement.scroll({top:0})}onSortChanged(e,t){this.sortedChanged.emit({isShift:e,colId:t}),this.scrollTableToTop()}afterTableInit(){}emitSelection(e){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=J.Xpm({type:e,selectors:[["sm-workers-table"]],viewQuery:function(e,t){if(1&e&&(J.Gf(lt,7),J.Gf(ct,5)),2&e){let e;J.iGM(e=J.CRH())&&(t.tableContainer=e.first),J.iGM(e=J.CRH())&&(t.table=e.first)}},inputs:{workers:"workers",selectedWorker:"selectedWorker"},outputs:{workerSelected:"workerSelected",sortedChanged:"sortedChanged"},features:[J.qOj],decls:12,vars:8,consts:[[1,"worker-container"],["tableContainer",""],[3,"tableData","selection","reorderableColumns","resizableColumns","scrollable","columns","rowsNumber","rowHeight","rowSelectionChanged"],["table",""],["pTemplate","body"],["pTemplate","sort-filter"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],["matTooltipPosition","above",1,"first-content",3,"smTooltip"],[3,"column","sortOrder","sortOrderChanged"]],template:function(e,t){1&e&&(J.TgZ(0,"div",0,1),J._uU(2,"\n  "),J.TgZ(3,"sm-table",2,3),J.NdJ("rowSelectionChanged",function(e){return t.onRowClicked(e)}),J._uU(5,"\n    "),J.YNc(6,_t,10,3,"ng-template",4),J._uU(7,"\n\n    "),J.YNc(8,ft,4,4,"ng-template",5),J._uU(9,"\n  "),J.qZA(),J._uU(10,"\n"),J.qZA(),J._uU(11,"\n\n\n\n")),2&e&&(J.xp6(3),J.Q6J("tableData",t.workers)("selection",t.selectedWorker)("reorderableColumns",!1)("resizableColumns",!1)("scrollable",!0)("columns",t.cols)("rowsNumber",100)("rowHeight",40))},directives:[it.a,ot.jx,i.RF,i.n9,i.ED,i.O5,Ge.i,at.O],pipes:[ut.v],styles:["[_nghost-%COMP%]   .first[_ngcontent-%COMP%]{display:block;padding-left:44px}[_nghost-%COMP%]   .first-content[_ngcontent-%COMP%]{padding-left:42px}.worker-container[_ngcontent-%COMP%]{margin-bottom:40px}"]}),e})();var vt=n(70467),xt=n(33821),Et=n(84840),Tt=n(47967);function wt(e,t){1&e&&(J.TgZ(0,"div",8),J._uU(1,"No queues currently assigned to this worker\n"),J.qZA())}const bt=function(){return["../queues"]},kt=function(e){return{id:e}};function Ot(e,t){if(1&e&&(J._uU(0,"\n      "),J._uU(1,"\n      "),J.TgZ(2,"div",11),J._uU(3,"\n        "),J.TgZ(4,"a",12),J._uU(5),J.qZA(),J._uU(6,"\n        "),J.TgZ(7,"sm-copy-clipboard",13),J._uU(8,"\n        "),J.qZA(),J._uU(9,"\n      "),J.qZA(),J._uU(10,"\n\n      "),J._uU(11,"\n      "),J.TgZ(12,"div",14),J._uU(13),J.qZA(),J._uU(14,"\n\n      "),J._uU(15,"\n      "),J.TgZ(16,"div",15),J._uU(17),J.qZA(),J._uU(18,"\n    ")),2&e){const e=t.row;J.xp6(4),J.Q6J("routerLink",J.DdM(9,bt))("queryParams",J.VKq(10,kt,e.id)),J.xp6(1),J.Oqu(null==e?null:e.name),J.xp6(2),J.Q6J("hideBackground",!0)("label","")("tooltipText","Copy Queue ID")("clipboardText",null==e?null:e.id),J.xp6(6),J.hij("\n        ",null==e||null==e.next_task?null:e.next_task.name,"\n      "),J.xp6(4),J.hij("\n        ",null==e?null:e.num_tasks,"\n      ")}}function Qt(e,t){if(1&e&&(J.TgZ(0,"div",9),J._uU(1,"\n  "),J.TgZ(2,"sm-simple-table-2",10),J._uU(3,"\n    "),J.YNc(4,Ot,19,12,"ng-template"),J._uU(5,"\n  "),J.qZA(),J._uU(6,"\n"),J.qZA()),2&e){const e=J.oxw();J.xp6(2),J.Q6J("cols",e.cols)("rowsData",null==e.selectedWorker?null:e.selectedWorker.queues)}}function Ct(e,t){if(1&e&&(J.TgZ(0,"a",25),J._uU(1),J.qZA()),2&e){const e=J.oxw(2);J.Q6J("href","/projects/"+(null!=e.selectedWorker&&null!=e.selectedWorker.task&&null!=e.selectedWorker.task.project&&e.selectedWorker.task.project.id?null==e.selectedWorker||null==e.selectedWorker.task||null==e.selectedWorker.task.project?null:e.selectedWorker.task.project.id:"*")+"/experiments/"+(null==e.selectedWorker||null==e.selectedWorker.task?null:e.selectedWorker.task.id),J.LSH),J.xp6(1),J.Oqu(null==e.selectedWorker||null==e.selectedWorker.task?null:e.selectedWorker.task.name)}}function qt(e,t){1&e&&J._uU(0,"\u2014")}function yt(e,t){if(1&e&&(J.TgZ(0,"div",16),J._uU(1,"\n  "),J.TgZ(2,"div",17),J._uU(3,"\n    "),J.TgZ(4,"div",14),J._uU(5,"\n      "),J.TgZ(6,"sm-vertical-labeled-row",18),J._uU(7),J.qZA(),J._uU(8,"\n      "),J.TgZ(9,"sm-vertical-labeled-row",19),J._uU(10),J.ALo(11,"timeAgo"),J.qZA(),J._uU(12,"\n      "),J.TgZ(13,"sm-vertical-labeled-row",20),J._uU(14,"\n        "),J.YNc(15,Ct,2,2,"a",21),J._uU(16,"\n        "),J.YNc(17,qt,1,0,"ng-template",null,22,J.W1O),J._uU(19,"\n      "),J.qZA(),J._uU(20,"\n    "),J.qZA(),J._uU(21,"\n    "),J.TgZ(22,"div",14),J._uU(23,"\n      "),J.TgZ(24,"sm-vertical-labeled-row",23),J._uU(25),J.ALo(26,"msToSec"),J.qZA(),J._uU(27,"\n      "),J.TgZ(28,"sm-vertical-labeled-row",24),J._uU(29),J.qZA(),J._uU(30,"\n    "),J.qZA(),J._uU(31,"\n  "),J.qZA(),J._uU(32,"\n"),J.qZA()),2&e){const e=J.MAs(18),t=J.oxw();let n;J.xp6(7),J.Oqu(null!==(n=null==t.selectedWorker?null:t.selectedWorker.name)&&void 0!==n?n:"\u2014"),J.xp6(3),J.Oqu(J.lcZ(11,6,null==t.selectedWorker?null:t.selectedWorker.last_report_time)),J.xp6(5),J.Q6J("ngIf",null==t.selectedWorker||null==t.selectedWorker.task?null:t.selectedWorker.task.name)("ngIfElse",e),J.xp6(10),J.Oqu(null!=t.selectedWorker&&null!=t.selectedWorker.task&&t.selectedWorker.task.running_time?J.lcZ(26,8,null==t.selectedWorker||null==t.selectedWorker.task?null:t.selectedWorker.task.running_time):"\u2014"),J.xp6(4),J.Oqu(null!=t.selectedWorker&&null!=t.selectedWorker.task&&t.selectedWorker.task.last_iteration?null==t.selectedWorker||null==t.selectedWorker.task?null:t.selectedWorker.task.last_iteration:"\u2014")}}let Mt=(()=>{class e{constructor(){this.deselectWorker=new J.vpe,this.activeTab="info",this.cols=[{header:"QUEUE",class:"col-8"},{header:"NEXT EXPERIMENT",class:"col-12"},{header:"IN QUEUE",class:"col-4"}]}deselectWorkerClicked(){this.deselectWorker.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=J.Xpm({type:e,selectors:[["sm-worker-info"]],inputs:{selectedWorker:"selectedWorker"},outputs:{deselectWorker:"deselectWorker"},decls:18,vars:5,consts:[[1,"d-flex","justify-content-center","tabs-container"],["header","info",3,"active","click"],["header","queues",3,"active","click"],[1,"pull-right","pointer",3,"click"],[1,"al-icon","al-ico-dialog-x","sm-md"],["class","d-flex align-items-center justify-content-center p-4",4,"ngIf"],["class","queues-table-container",4,"ngIf"],["class","worker-info-container",4,"ngIf"],[1,"d-flex","align-items-center","justify-content-center","p-4"],[1,"queues-table-container"],[1,"dark-theme",3,"cols","rowsData"],[1,"col-8","id-cell","d-flex"],[1,"value","link",3,"routerLink","queryParams"],[1,"copy-btn",3,"hideBackground","label","tooltipText","clipboardText"],[1,"col-12"],[1,"col-4"],[1,"worker-info-container"],[1,"row"],["label","Worker Name"],["label","Update Time"],["label","Current Experiment"],["target","_blank",3,"href",4,"ngIf","ngIfElse"],["notRelevant",""],["label","Experiment Run Time"],["label","Experiment Iteration"],["target","_blank",3,"href"]],template:function(e,t){1&e&&(J.TgZ(0,"div",0),J._uU(1,"\n  "),J.TgZ(2,"sm-navbar-item",1),J.NdJ("click",function(){return t.activeTab="info"}),J.qZA(),J._uU(3,"\n  "),J.TgZ(4,"sm-navbar-item",2),J.NdJ("click",function(){return t.activeTab="queues"}),J.qZA(),J._uU(5,"\n  "),J.TgZ(6,"div",3),J.NdJ("click",function(){return t.deselectWorkerClicked()}),J._uU(7,"\n    "),J._UZ(8,"i",4),J._uU(9,"\n  "),J.qZA(),J._uU(10,"\n"),J.qZA(),J._uU(11,"\n"),J.YNc(12,wt,2,0,"div",5),J._uU(13,"\n"),J.YNc(14,Qt,7,2,"div",6),J._uU(15,"\n\n"),J.YNc(16,yt,33,10,"div",7),J._uU(17,"\n\n")),2&e&&(J.xp6(2),J.Q6J("active","info"===t.activeTab),J.xp6(2),J.Q6J("active","queues"===t.activeTab),J.xp6(8),J.Q6J("ngIf","queues"===t.activeTab&&0===(null==t.selectedWorker?null:t.selectedWorker.queues.length)),J.xp6(2),J.Q6J("ngIf","queues"===t.activeTab&&(null==t.selectedWorker?null:t.selectedWorker.queues.length)>0),J.xp6(2),J.Q6J("ngIf","info"===t.activeTab))},directives:[X.f,i.O5,vt.g,r.yS,xt.y,Et.u],pipes:[Tt.e,ut.v],styles:["[_nghost-%COMP%]   .worker-info-container[_ngcontent-%COMP%]{padding:12px 0}[_nghost-%COMP%]     .table-row{line-height:unset!important;height:40px;background-color:#1a1e2c!important;border-bottom:1px solid #303443!important}[_nghost-%COMP%]     .row.headers{line-height:48px!important;border-bottom:1px solid #303443!important;color:#5a658e}[_nghost-%COMP%]   .tabs-container[_ngcontent-%COMP%]{position:relative;background-color:#1a1e2c;border-bottom:1px solid #303443;margin:12px 0 0;height:38px}[_nghost-%COMP%]   .tabs-container[_ngcontent-%COMP%]     .navbar-item{height:100%;padding:0 15px;margin:0 1px}[_nghost-%COMP%]   .pull-right[_ngcontent-%COMP%]{position:absolute;right:24px;top:0}[_nghost-%COMP%]   .id-cell[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .id-cell[_ngcontent-%COMP%]   .copy-btn[_ngcontent-%COMP%]{min-width:30px;margin-left:5px;visibility:hidden}[_nghost-%COMP%]   .id-cell[_ngcontent-%COMP%]   .copy-btn[_ngcontent-%COMP%]     .btn{padding:0}[_nghost-%COMP%]   .id-cell[_ngcontent-%COMP%]:hover   .copy-btn[_ngcontent-%COMP%]{visibility:visible}"]}),e})(),At=(()=>{class e{constructor(e,t,n){this.store=e,this.router=t,this.route=n,this.workers$=this.store.select(Pe),this.selectedWorker$=this.store.select(Ne),this.tableSortFields$=this.store.select(De)}get routerWorkerId(){return new URL(window.location.href).searchParams.get("id")}ngOnInit(){this.workers$.pipe((0,Le.M)(this.selectedWorker$),(0,o.h)(([e,t])=>e&&(null==t?void 0:t.id)!==this.routerWorkerId),(0,a.q)(1)).subscribe(([e])=>{const t=e.find(e=>e.id===this.routerWorkerId);this.selectWorker(t)})}selectWorker(e){this.router.navigate([],{relativeTo:this.route,queryParams:{id:null==e?void 0:e.id},queryParamsHandling:"merge"}),this.store.dispatch(ae({worker:e}))}sortedChanged(e){this.store.dispatch(le({colId:e.colId,isShift:e.isShift}))}}return e.\u0275fac=function(t){return new(t||e)(J.Y36(u.yh),J.Y36(r.F0),J.Y36(r.gz))},e.\u0275cmp=J.Xpm({type:e,selectors:[["sm-workers"]],decls:23,vars:20,consts:[[1,"overflow-hidden",3,"worker"],[1,"flex-grow-1"],[3,"size"],[1,"mt-2",3,"workers","selectedWorker","tableSortFields","sortedChanged","workerSelected"],[3,"size","visible"],[3,"selectedWorker","deselectWorker"]],template:function(e,t){1&e&&(J._UZ(0,"sm-workers-graph",0),J.ALo(1,"async"),J._uU(2,"\n"),J.TgZ(3,"as-split",1),J._uU(4,"\n  "),J.TgZ(5,"as-split-area",2),J._uU(6,"\n    "),J.TgZ(7,"sm-workers-table",3),J.NdJ("sortedChanged",function(e){return t.sortedChanged(e)})("workerSelected",function(e){return t.selectWorker(e)}),J.ALo(8,"async"),J.ALo(9,"async"),J.ALo(10,"async"),J._uU(11,"\n    "),J.qZA(),J._uU(12,"\n  "),J.qZA(),J._uU(13,"\n  "),J.TgZ(14,"as-split-area",4),J.ALo(15,"async"),J._uU(16,"\n    "),J.TgZ(17,"sm-worker-info",5),J.NdJ("deselectWorker",function(){return t.selectWorker(null)}),J.ALo(18,"async"),J._uU(19,"\n    "),J.qZA(),J._uU(20,"\n  "),J.qZA(),J._uU(21,"\n"),J.qZA(),J._uU(22,"\n")),2&e&&(J.Q6J("worker",J.lcZ(1,8,t.selectedWorker$)),J.xp6(5),J.Q6J("size",50),J.xp6(2),J.Q6J("workers",J.lcZ(8,10,t.workers$))("selectedWorker",J.lcZ(9,12,t.selectedWorker$))("tableSortFields",J.lcZ(10,14,t.tableSortFields$)),J.xp6(7),J.Q6J("size",50)("visible",!!J.lcZ(15,16,t.selectedWorker$)),J.xp6(3),J.Q6J("selectedWorker",J.lcZ(18,18,t.selectedWorker$)))},directives:[nt,st.Mq,st.zE,Ut,Mt],pipes:[i.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:calc(100% - 66px)}[_nghost-%COMP%]   sm-workers-graph[_ngcontent-%COMP%]{margin:0 50px 20px}[_nghost-%COMP%]   as-split[_ngcontent-%COMP%]{height:calc(100% - 364px);min-height:180px}"]}),e})();const Zt=["waitchart"],St=["lenchart"];function Pt(e,t){1&e&&(J.TgZ(0,"i",15),J._uU(1,"\n        "),J.qZA())}function It(e,t){1&e&&(J.TgZ(0,"i",15),J._uU(1,"\n        "),J.qZA())}function Nt(e,t){if(1&e&&(J.TgZ(0,"mat-option",16),J._uU(1),J.qZA()),2&e){const e=t.$implicit;J.Q6J("value",e.value),J.xp6(1),J.hij("\n              ",e.label,"\n            ")}}let Dt=(()=>{class e{constructor(e){this.store=e,this.statsError$=this.store.select(We),this.refreshChart=!0,this.timeFrameOptions=[{label:"3 Hours",value:(3*fe.HOUR).toString()},{label:"6 Hours",value:(6*fe.HOUR).toString()},{label:"12 Hours",value:(12*fe.HOUR).toString()},{label:"1 Day",value:fe.DAY.toString()},{label:"1 Week",value:fe.WEEK.toString()},{label:"1 Month",value:fe.MONTH.toString()}],this.trackByFn=(e,t)=>t.value}set queue(e){this.selectedQueue!==e&&(this.selectedQueue=e,this.updateChart())}ngOnInit(){this.chartParamSubscription=this.store.select(Ae).pipe((0,o.h)(e=>!!e)).subscribe(e=>{this.currentTimeFrame=e,this.updateChart()}),this.chartDataSubscription=this.store.select(Me).subscribe(e=>{e&&(e.wait||e.length)&&(this.refreshChart=!1,this.waitChartData={dataByTopic:e.wait},this.lenChartData={dataByTopic:e.length})}),this.updateChart()}ngOnDestroy(){this.chartDataSubscription.unsubscribe(),this.chartParamSubscription.unsubscribe(),clearInterval(this.intervaleHandle)}updateChart(){clearInterval(this.intervaleHandle),this.refreshChart=!0,this.store.dispatch(k({data:{wait:null,length:null}}));const e=parseInt(this.currentTimeFrame,10);let t=1e3|this.waitChartRef.element.nativeElement.clientWidth;t=Math.min(.8*t,1e3);const n=Math.max(Math.floor(e/t),5);this.store.dispatch(b({maxPoints:t})),this.intervaleHandle=window.setInterval(()=>{this.store.dispatch(b({maxPoints:t}))},1e3*n)}tickFormatter(e){e=Math.floor(e);const t=Math.floor(e/3600);return e%=3600,`${t}:${(""+Math.floor(e/60)%100).padStart(2,"0")}:${(""+e%60).padStart(2,"0")}`}timeFrameChanged(e){this.store.dispatch(O({timeFrame:e}))}}return e.\u0275fac=function(t){return new(t||e)(J.Y36(u.yh))},e.\u0275cmp=J.Xpm({type:e,selectors:[["sm-queue-stats"]],viewQuery:function(e,t){if(1&e&&(J.Gf(Zt,7,J.s_b),J.Gf(St,7,J.s_b)),2&e){let e;J.iGM(e=J.CRH())&&(t.waitChartRef=e.first),J.iGM(e=J.CRH())&&(t.lenChartRef=e.first)}},inputs:{queue:"queue"},decls:56,vars:17,consts:[[1,"d-flex"],[1,"chart-container","overflow-hidden"],[1,"header"],[1,"title"],[1,"ellipsis"],["class","warnning fas fa-exclamation-triangle","smTooltip","Data temporarily not available",4,"ngIf"],[1,"line-chart-container"],["waitchart",""],[3,"data","showLoadingOverlay","tooltipVerticalOffset"],[1,"chart-container","right","overflow-hidden"],[1,"time-selector"],["appearance","outline",1,"dark-outline","thin","time-selector"],["name","time-frame","panelClass","dark-outline",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],["lenchart",""],["smTooltip","Data temporarily not available",1,"warnning","fas","fa-exclamation-triangle"],[3,"value"]],template:function(e,t){1&e&&(J.TgZ(0,"div",0),J._uU(1,"\n  "),J.TgZ(2,"div",1),J._uU(3,"\n    "),J.TgZ(4,"div",2),J._uU(5,"\n      "),J.TgZ(6,"div",3),J._uU(7,"\n        "),J.TgZ(8,"div",4),J._uU(9),J.qZA(),J._uU(10,"\n        "),J.YNc(11,Pt,2,0,"i",5),J.ALo(12,"async"),J._uU(13,"\n      "),J.qZA(),J._uU(14,"\n    "),J.qZA(),J._uU(15,"\n    "),J.TgZ(16,"div",6,7),J._uU(18,"\n      "),J._UZ(19,"sm-line-chart",8),J._uU(20,"\n    "),J.qZA(),J._uU(21,"\n  "),J.qZA(),J._uU(22,"\n  "),J.TgZ(23,"div",9),J._uU(24,"\n    "),J.TgZ(25,"div",2),J._uU(26,"\n      "),J.TgZ(27,"div",3),J._uU(28,"\n        "),J.TgZ(29,"div",4),J._uU(30),J.qZA(),J._uU(31,"\n        "),J.YNc(32,It,2,0,"i",5),J.ALo(33,"async"),J._uU(34,"\n      "),J.qZA(),J._uU(35,"\n      "),J.TgZ(36,"div",10),J._uU(37,"\n        "),J.TgZ(38,"mat-form-field",11),J._uU(39,"\n          "),J.TgZ(40,"mat-select",12),J.NdJ("ngModelChange",function(e){return t.timeFrameChanged(e)}),J._uU(41,"\n            "),J.YNc(42,Nt,2,2,"mat-option",13),J._uU(43,"\n          "),J.qZA(),J._uU(44,"\n        "),J.qZA(),J._uU(45,"\n      "),J.qZA(),J._uU(46,"\n    "),J.qZA(),J._uU(47,"\n    "),J.TgZ(48,"div",6,14),J._uU(50,"\n      "),J._UZ(51,"sm-line-chart",8),J._uU(52,"\n    "),J.qZA(),J._uU(53,"\n  "),J.qZA(),J._uU(54,"\n"),J.qZA(),J._uU(55,"\n")),2&e&&(J.xp6(9),J.hij("",t.selectedQueue?t.selectedQueue.name:"Overall"," Experiment Wait Time"),J.xp6(2),J.Q6J("ngIf",J.lcZ(12,13,t.statsError$)),J.xp6(8),J.Q6J("data",t.waitChartData)("showLoadingOverlay",t.refreshChart)("tooltipVerticalOffset",-60),J.xp6(11),J.hij("",t.selectedQueue?t.selectedQueue.name:"Overall"," Queued Experiments"),J.xp6(2),J.Q6J("ngIf",J.lcZ(33,15,t.statsError$)),J.xp6(8),J.Q6J("ngModel",t.currentTimeFrame),J.xp6(2),J.Q6J("ngForOf",t.timeFrameOptions)("ngForTrackBy",t.trackByFn),J.xp6(9),J.Q6J("data",t.lenChartData)("showLoadingOverlay",t.refreshChart)("tooltipVerticalOffset",-60))},directives:[i.O5,Ye.D,L.KE,Be.gD,s.JJ,s.On,i.sg,Ge.i,ze.ey],pipes:[i.Ov],styles:["[_nghost-%COMP%]{display:block;margin:0 50px 20px}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{height:364px}[_nghost-%COMP%]   .chart-container[_ngcontent-%COMP%]{padding:20px 20px 0;background-color:#000;border:1px solid #39405f;width:50%}[_nghost-%COMP%]   .chart-container.right[_ngcontent-%COMP%]{margin-left:20px}[_nghost-%COMP%]   .chart-container[_ngcontent-%COMP%]   .line-chart-container[_ngcontent-%COMP%]{height:calc(100% - 48px);position:relative;z-index:500}[_nghost-%COMP%]   .chart-container[_ngcontent-%COMP%]   .line-chart-container[_ngcontent-%COMP%]   sm-line-chart[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   .chart-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;height:48px;line-height:47px;width:100%;white-space:nowrap}[_nghost-%COMP%]   .chart-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:16px;font-size:15px;text-transform:uppercase;white-space:nowrap;overflow:hidden}[_nghost-%COMP%]   .chart-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .time-selector[_ngcontent-%COMP%]{width:150px}[_nghost-%COMP%]   .chart-container[_ngcontent-%COMP%]   .warnning[_ngcontent-%COMP%]{margin-left:10px;color:red}"]}),e})();var Rt=n(15869),Ft=n(89744),Jt=n(2237);function Wt(e,t){if(1&e){const e=J.EpF();J.TgZ(0,"sm-menu",1),J._uU(1,"\n    "),J.TgZ(2,"sm-menu-item",2),J.NdJ("itemClicked",function(){J.CHM(e);const t=J.oxw();return t.deleteQueue.emit(t.selectedQueue)}),J.qZA(),J._uU(3,"\n    "),J.TgZ(4,"sm-menu-item",3),J.NdJ("itemClicked",function(){J.CHM(e);const t=J.oxw();return t.renameQueue.emit(t.selectedQueue)}),J.qZA(),J._uU(5,"\n  "),J.Hsn(6),J._uU(7,"\n  "),J.qZA()}if(2&e){const e=J.oxw();J.Q6J("position",e.menuPosition)("showCart",!1)("showOverlay",!1)("showButton",!1)("openOnInit",!0),J.xp6(2),J.Q6J("disabled",(null==e.selectedQueue||null==e.selectedQueue.entries?null:e.selectedQueue.entries.length)>0)}}const Lt=[[["","extendedQueuesMenu",""]]],Ht=["[extendedQueuesMenu]"];let jt=(()=>{class e{constructor(e){this.route=e,this.ICONS=Rt.UZ,this.deleteQueue=new J.vpe,this.renameQueue=new J.vpe,this.queuesManager=e.snapshot.data.queuesManager}}return e.\u0275fac=function(t){return new(t||e)(J.Y36(r.gz))},e.\u0275cmp=J.Xpm({type:e,selectors:[["sm-queues-menu"]],inputs:{menuOpen:"menuOpen",selectedQueue:"selectedQueue",menuPosition:"menuPosition"},outputs:{deleteQueue:"deleteQueue",renameQueue:"renameQueue"},ngContentSelectors:Ht,decls:2,vars:1,consts:[["buttonClass","al-icon sm-md al-ico-bars-menu al-color light-grey-blue",3,"position","header","showCart","showOverlay","showButton","openOnInit",4,"ngIf"],["buttonClass","al-icon sm-md al-ico-bars-menu al-color light-grey-blue",3,"position","header","showCart","showOverlay","showButton","openOnInit"],["itemLabel","Delete",3,"disabled","itemClicked"],["itemLabel","Rename",3,"itemClicked"]],template:function(e,t){1&e&&(J.F$t(Lt),J.YNc(0,Wt,8,6,"sm-menu",0),J._uU(1,"\n\n")),2&e&&J.Q6J("ngIf",t.menuOpen&&t.queuesManager)},directives:[i.O5,Ft.M,Jt.q],styles:[""]}),e})();function Bt(e,t){if(1&e){const e=J.EpF();J.TgZ(0,"sm-menu",1),J._uU(1,"\n    "),J.TgZ(2,"sm-menu-item",2),J.NdJ("itemClicked",function(){J.CHM(e);const t=J.oxw();return t.deleteQueue.emit(t.selectedQueue)}),J.qZA(),J._uU(3,"\n    "),J.TgZ(4,"sm-menu-item",3),J.NdJ("itemClicked",function(){J.CHM(e);const t=J.oxw();return t.renameQueue.emit(t.selectedQueue)}),J.qZA(),J._uU(5,"\n  "),J.Hsn(6),J._uU(7,"\n  "),J.qZA()}if(2&e){const e=J.oxw();J.Q6J("position",e.menuPosition)("showCart",!1)("showOverlay",!1)("showButton",!1)("openOnInit",!0),J.xp6(2),J.Q6J("disabled",(null==e.selectedQueue||null==e.selectedQueue.entries?null:e.selectedQueue.entries.length)>0)}}const Yt=[[["","extendedQueuesMenu",""]]],zt=["[extendedQueuesMenu]"];let Gt=(()=>{class e extends jt{set contextMenu(e){}get contextMenu(){return this}}return e.\u0275fac=function(){let t;return function(n){return(t||(t=J.n5z(e)))(n||e)}}(),e.\u0275cmp=J.Xpm({type:e,selectors:[["sm-queues-menu-extended"]],features:[J.qOj],ngContentSelectors:zt,decls:2,vars:1,consts:[["buttonClass","al-icon sm-md al-ico-bars-menu al-color light-grey-blue",3,"position","header","showCart","showOverlay","showButton","openOnInit",4,"ngIf"],["buttonClass","al-icon sm-md al-ico-bars-menu al-color light-grey-blue",3,"position","header","showCart","showOverlay","showButton","openOnInit"],["itemLabel","Delete",3,"disabled","itemClicked"],["itemLabel","Rename",3,"itemClicked"]],template:function(e,t){1&e&&(J.F$t(Yt),J.YNc(0,Bt,8,6,"sm-menu",0),J._uU(1,"\n\n")),2&e&&J.Q6J("ngIf",t.menuOpen&&t.queuesManager)},directives:[i.O5,Ft.M,Jt.q],styles:[""]}),e})();const Kt=["tableContainer"],$t=["table"];function Xt(e,t){if(1&e){const e=J.EpF();J._uU(0,"\n      "),J.TgZ(1,"sm-table-filter-sort-template",7),J.NdJ("sortOrderChanged",function(t){const n=J.CHM(e).$implicit;return J.oxw().onSortChanged(t,n.id)}),J._uU(2,"\n      "),J.qZA(),J._uU(3,"\n    ")}if(2&e){const e=t.$implicit,n=J.oxw();J.xp6(1),J.ekj("first",e.id===n.QUEUES_TABLE_COL_FIELDS.NAME),J.Q6J("column",e)("sortOrder",n.tableSortFieldsObject[e.id])}}function Vt(e,t){if(1&e&&(J.TgZ(0,"div",12),J._uU(1,"\n          "),J.TgZ(2,"div",13),J._uU(3),J.qZA(),J._uU(4,"\n          "),J._UZ(5,"sm-copy-clipboard",14),J._uU(6,"\n        "),J.qZA()),2&e){const e=J.oxw().rowData;J.xp6(2),J.Q6J("smTooltip",null==e?null:e.name),J.xp6(1),J.Oqu(null==e?null:e.name),J.xp6(2),J.Q6J("clipboardText",null==e?null:e.id)("hideBackground",!0)("label","")("tooltipText","Copy Queue ID")}}function en(e,t){1&e&&(J.TgZ(0,"span"),J._uU(1,"\u2014"),J.qZA())}function tn(e,t){if(1&e&&(J.ynx(0),J._uU(1,"\n          "),J.TgZ(2,"span"),J._uU(3),J.qZA(),J._uU(4,"\n          "),J.YNc(5,en,2,0,"span",15),J._uU(6,"\n        "),J.BQk()),2&e){const e=J.oxw().rowData;J.xp6(3),J.Oqu(null==e||null==e.entries[0]||null==e.entries[0].task?null:e.entries[0].task.name),J.xp6(2),J.Q6J("ngIf",!(null!=e&&null!=e.entries[0]&&null!=e.entries[0].task&&e.entries[0].task.name))}}function nn(e,t){1&e&&(J.TgZ(0,"span"),J._uU(1,"\u2014"),J.qZA())}function sn(e,t){if(1&e&&(J.ynx(0),J._uU(1,"\n          "),J.TgZ(2,"span"),J._uU(3),J.ALo(4,"timeAgo"),J.qZA(),J._uU(5,"\n          "),J.YNc(6,nn,2,0,"span",15),J._uU(7,"\n        "),J.BQk()),2&e){const e=J.oxw().rowData;J.xp6(3),J.Oqu(J.lcZ(4,2,null==e?null:e.last_update)),J.xp6(3),J.Q6J("ngIf",!(null!=e&&e.last_update))}}function rn(e,t){1&e&&(J.TgZ(0,"span"),J._uU(1,"\u2014"),J.qZA())}function on(e,t){if(1&e&&(J.ynx(0),J._uU(1,"\n          "),J.TgZ(2,"span"),J._uU(3),J.YNc(4,rn,2,0,"span",15),J._uU(5,"\n          "),J.qZA(),J._uU(6,"\n        "),J.BQk()),2&e){const e=J.oxw().rowData;J.xp6(3),J.hij("\n            ",0===(null==e||null==e.entries?null:e.entries.length)?"":null==e||null==e.entries?null:e.entries.length,"\n            "),J.xp6(1),J.Q6J("ngIf",0===(null==e||null==e.entries?null:e.entries.length))}}function an(e,t){if(1&e&&(J.ynx(0),J._uU(1),J.BQk()),2&e){const e=J.oxw(),t=e.rowData,n=e.$implicit,s=J.oxw();J.xp6(1),J.hij("\n          ",s.getBodyData(t,n),"\n        ")}}function un(e,t){if(1&e&&(J._uU(0,"\n      "),J.ynx(1,8),J._uU(2,"\n        "),J.YNc(3,Vt,7,6,"div",9),J._uU(4,"\n        "),J.YNc(5,tn,7,2,"ng-container",10),J._uU(6,"\n        "),J.YNc(7,sn,8,4,"ng-container",10),J._uU(8,"\n        "),J.YNc(9,on,7,2,"ng-container",10),J._uU(10,"\n        "),J.YNc(11,an,2,1,"ng-container",11),J._uU(12,"\n      "),J.BQk(),J._uU(13,"\n    ")),2&e){const e=t.$implicit,n=J.oxw();J.xp6(1),J.Q6J("ngSwitch",e.id),J.xp6(2),J.Q6J("ngSwitchCase",n.QUEUES_TABLE_COL_FIELDS.NAME),J.xp6(2),J.Q6J("ngSwitchCase",n.QUEUES_TABLE_COL_FIELDS.TASK),J.xp6(2),J.Q6J("ngSwitchCase",n.QUEUES_TABLE_COL_FIELDS.LAST_UPDATED),J.xp6(2),J.Q6J("ngSwitchCase",n.QUEUES_TABLE_COL_FIELDS.IN_QUEUE)}}let ln=(()=>{class e extends rt.E{constructor(e,t){super(),this.changeDetector=e,this.route=t,this.QUEUES_TABLE_COL_FIELDS=he,this.ICONS=Rt.UZ,this.queueSelected=new J.vpe,this.deleteQueue=new J.vpe,this.renameQueue=new J.vpe,this.sortedChanged=new J.vpe,this.queuesManager=t.snapshot.data.queuesManager,this.cols=[{id:he.NAME,headerType:Ue.Ic.sortFilter,header:"QUEUE",style:{width:"35%"},sortable:!0},{id:he.TASK,headerType:Ue.Ic.sortFilter,header:"NEXT EXPERIMENT",style:{width:"30%"},sortable:!0},{id:he.LAST_UPDATED,headerType:Ue.Ic.sortFilter,header:"LAST UPDATED",style:{width:"150px"},sortable:!0},{id:he.IN_QUEUE,headerType:Ue.Ic.sortFilter,header:"IN QUEUE",style:{width:"100px"},sortable:!0}]}set queues(e){this._queues=e,this.table&&this.table.focusSelected()}get queues(){return this._queues}clickHandler(e){2!=e.button&&(this.menuOpen=!1)}getBodyData(e,t){return(0,je.get)(t.id,e)}getQNames(e){return e.map(e=>this.getQName(e))}getQName(e){const t=(0,je.find)({id:e},this.queues);return t?t.name:e}onRowClicked(e){this.queueSelected.emit(e.data)}openContextMenu(e){e.e.preventDefault(),this.queueSelected.emit(e.rowData),this.menuOpen=!1,setTimeout(()=>{this.menuPosition={x:e.e.clientX,y:e.e.clientY},this.menuOpen=!0,this.changeDetector.detectChanges()},0)}scrollTableToTop(){this.tableContainer.nativeElement.scroll({top:0})}onSortChanged(e,t){this.sortedChanged.emit({isShift:e,colId:t}),this.scrollTableToTop()}afterTableInit(){}emitSelection(e){}}return e.\u0275fac=function(t){return new(t||e)(J.Y36(J.sBO),J.Y36(r.gz))},e.\u0275cmp=J.Xpm({type:e,selectors:[["sm-queues-table"]],viewQuery:function(e,t){if(1&e&&(J.Gf(Kt,5),J.Gf($t,5)),2&e){let e;J.iGM(e=J.CRH())&&(t.tableContainer=e.first),J.iGM(e=J.CRH())&&(t.table=e.first)}},hostBindings:function(e,t){1&e&&J.NdJ("click",function(e){return t.clickHandler(e)},!1,J.evT)},inputs:{queues:"queues",selectedQueue:"selectedQueue",tableSortOrder:"tableSortOrder"},outputs:{queueSelected:"queueSelected",deleteQueue:"deleteQueue",renameQueue:"renameQueue",sortedChanged:"sortedChanged"},features:[J.qOj],decls:14,vars:11,consts:[[1,"queues-container"],["tableContainer",""],[3,"menuOpen","menuPosition","selectedQueue","deleteQueue","renameQueue"],[3,"tableData","columns","rowsNumber","rowHeight","reorderableColumns","resizableColumns","scrollable","selection","rowSelectionChanged","onRowRightClick"],["table",""],["pTemplate","sort-filter"],["pTemplate","body"],[3,"column","sortOrder","sortOrderChanged"],[1,"table-cell",3,"ngSwitch"],["class","w-100 d-flex align-items-center pr-3 first id-cell",4,"ngSwitchCase"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"w-100","d-flex","align-items-center","pr-3","first","id-cell"],["matTooltipPosition","above",1,"queue-name",3,"smTooltip"],[1,"copy-btn",3,"clipboardText","hideBackground","label","tooltipText"],[4,"ngIf"]],template:function(e,t){1&e&&(J.TgZ(0,"div",0,1),J._uU(2,"\n  "),J.TgZ(3,"sm-queues-menu-extended",2),J.NdJ("deleteQueue",function(e){return t.deleteQueue.emit(e)})("renameQueue",function(){return t.renameQueue.emit(t.selectedQueue)}),J.qZA(),J._uU(4,"\n  "),J.TgZ(5,"sm-table",3,4),J.NdJ("rowSelectionChanged",function(e){return t.onRowClicked(e)})("onRowRightClick",function(e){return t.openContextMenu(e)}),J._uU(7,"\n    "),J.YNc(8,Xt,4,4,"ng-template",5),J._uU(9,"\n    "),J.YNc(10,un,14,5,"ng-template",6),J._uU(11,"\n  "),J.qZA(),J._uU(12,"\n"),J.qZA(),J._uU(13,"\n")),2&e&&(J.xp6(3),J.Q6J("menuOpen",t.menuOpen)("menuPosition",t.menuPosition)("selectedQueue",t.selectedQueue),J.xp6(2),J.Q6J("tableData",t.queues)("columns",t.cols)("rowsNumber",100)("rowHeight",40)("reorderableColumns",!1)("resizableColumns",!1)("scrollable",!0)("selection",t.selectedQueue))},directives:[Gt,it.a,ot.jx,at.O,i.RF,i.n9,i.ED,Ge.i,xt.y,i.O5],pipes:[Tt.e],styles:["[_nghost-%COMP%]   .first[_ngcontent-%COMP%]{display:block;padding-left:44px}[_nghost-%COMP%]   hr[_ngcontent-%COMP%]{margin:0!important}[_nghost-%COMP%]     .copy-btn .selected{background-color:#4d66ff;border:none}[_nghost-%COMP%]     .copy-btn .selected .light-color{color:#dce0ee}[_nghost-%COMP%]     .copy-btn .selected:hover{background-color:#4551af}.queues-container[_ngcontent-%COMP%]{width:100%;height:100%}.table-cell[_ngcontent-%COMP%]{font-size:13px}.id-cell[_ngcontent-%COMP%]{align-items:center}.id-cell[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{flex:1;line-height:32px;padding-left:10px}.id-cell[_ngcontent-%COMP%]   .value.first[_ngcontent-%COMP%]{padding-left:42px}.id-cell[_ngcontent-%COMP%]   .queue-name[_ngcontent-%COMP%]{flex:1;font-weight:500;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.id-cell[_ngcontent-%COMP%]   .copy-btn[_ngcontent-%COMP%]{min-width:30px;margin-left:5px;display:none}.id-cell[_ngcontent-%COMP%]:hover   .copy-btn[_ngcontent-%COMP%]{display:inline-block}"]}),e})();var cn=n(80395),dn=n(27654),pn=n(19314);function hn(e,t){1&e&&(J.TgZ(0,"div",9),J._uU(1,"No experiments currently enqueued\n"),J.qZA())}function mn(e,t){1&e&&(J.TgZ(0,"div",9),J._uU(1,"No workers currently assigned to this queue\n"),J.qZA())}const gn=function(){return["../workers"]},_n=function(e){return{id:e}};function fn(e,t){if(1&e&&(J._uU(0,"\n    "),J.TgZ(1,"a",11),J._uU(2),J.qZA(),J._uU(3,"\n    "),J.TgZ(4,"div",12),J._uU(5),J.qZA(),J._uU(6,"\n    "),J.TgZ(7,"div",12),J._uU(8,"\n      "),J.TgZ(9,"a",13),J._uU(10),J.qZA(),J._uU(11,"\n    "),J.qZA(),J._uU(12,"\n  ")),2&e){const e=t.row;J.xp6(1),J.Q6J("routerLink",J.DdM(6,gn))("queryParams",J.VKq(7,_n,e.name)),J.xp6(1),J.Oqu(null==e?null:e.name),J.xp6(3),J.hij("\n      ",e.ip,"\n    "),J.xp6(4),J.Q6J("href","/projects/"+(null!=e&&null!=e.task&&null!=e.task.project&&e.task.project.id?null==e||null==e.task||null==e.task.project?null:e.task.project.id:"*")+"/experiments/"+(null==e||null==e.task?null:e.task.id),J.LSH),J.xp6(1),J.hij(" ",null==e||null==e.task?null:e.task.name,"")}}function Un(e,t){if(1&e&&(J.TgZ(0,"sm-simple-table-2",10),J._uU(1,"\n  "),J.YNc(2,fn,13,9,"ng-template"),J._uU(3,"\n\n"),J.qZA()),2&e){const e=J.oxw();J.Q6J("cols",e.workersCols)("rowsData",null==e.selectedQueue?null:e.selectedQueue.workers)}}function vn(e,t){if(1&e){const e=J.EpF();J.TgZ(0,"sm-menu",14),J.NdJ("onMenuClosed",function(){return J.CHM(e),J.oxw().menuClosed()}),J._uU(1,"\n  "),J.TgZ(2,"sm-menu-item",15),J.NdJ("itemClicked",function(){return J.CHM(e),J.oxw().moveToTop()}),J._uU(3,"\n  "),J.qZA(),J._uU(4,"\n  "),J.TgZ(5,"sm-menu-item",16),J.NdJ("itemClicked",function(){return J.CHM(e),J.oxw().moveToBottom()}),J._uU(6,"\n  "),J.qZA(),J._uU(7,"\n  "),J.TgZ(8,"sm-menu-item",17),J.NdJ("itemClicked",function(){return J.CHM(e),J.oxw().moveToQueue()}),J._uU(9,"\n  "),J.qZA(),J._uU(10,"\n  "),J.TgZ(11,"sm-menu-item",18),J.NdJ("itemClicked",function(){return J.CHM(e),J.oxw().removeFromQueue()}),J._uU(12,"\n  "),J.qZA(),J._uU(13,"\n\n"),J.qZA()}if(2&e){const e=J.oxw();J.Q6J("position",e.menuPosition)("showCart",!1)("showOverlay",!1)("showButton",!1)("openOnInit",!0),J.xp6(2),J.Q6J("disabled",e.selectedQueue.entries.length<=0),J.xp6(3),J.Q6J("disabled",e.selectedQueue.entries.length<=0),J.xp6(3),J.Q6J("disabled",e.selectedQueue.entries.length<=0),J.xp6(3),J.Q6J("disabled",e.selectedQueue.entries.length<=0)("iconFontSize",12)}}function xn(e,t){if(1&e){const e=J.EpF();J._uU(0,"\n    "),J.TgZ(1,"div",20),J._uU(2,"\n      "),J._UZ(3,"i",21),J._uU(4,"\n    "),J.qZA(),J._uU(5,"\n    "),J.TgZ(6,"div",22),J._uU(7),J.qZA(),J._uU(8,"\n    "),J.TgZ(9,"div",12),J._uU(10,"\n      "),J.TgZ(11,"a",13),J._uU(12),J.qZA(),J._uU(13,"\n    "),J.qZA(),J._uU(14,"\n    "),J.TgZ(15,"div",22),J._uU(16,"\n      "),J.TgZ(17,"i",23),J.NdJ("click",function(t){const n=J.CHM(e).row;return J.oxw(2).openContextMenu(t,null==n?null:n.task)}),J.qZA(),J._uU(18,"\n    "),J.qZA(),J._uU(19,"\n  ")}if(2&e){const e=t.rowIndex,n=t.row;J.xp6(7),J.hij("\n      ",e+1,"\n    "),J.xp6(4),J.Q6J("href","/projects/"+(null!=n&&null!=n.task&&null!=n.task.project&&n.task.project.id?null==n||null==n.task||null==n.task.project?null:n.task.project.id:"*")+"/experiments/"+(null==n||null==n.task?null:n.task.id),J.LSH),J.xp6(1),J.hij("",null==n||null==n.task?null:n.task.name,"\n      ")}}function En(e,t){if(1&e){const e=J.EpF();J.TgZ(0,"sm-simple-table-2",19),J.NdJ("entryDropped",function(t){return J.CHM(e),J.oxw().experimentDropped(t)}),J._uU(1,"\n  "),J.YNc(2,xn,20,3,"ng-template"),J._uU(3,"\n"),J.qZA()}if(2&e){const e=J.oxw();J.Q6J("cols",e.experimentsCols)("rowsData",null==e.selectedQueue?null:e.selectedQueue.entries)("enableDragAndDrop",!0)}}let Tn=(()=>{class e{constructor(e,t,n){this.changeDetector=e,this.blTaskService=t,this.dialog=n,this.deselectQueue=new J.vpe,this.moveExperimentToTopOfQueue=new J.vpe,this.moveExperimentToBottomOfQueue=new J.vpe,this.moveExperimentToOtherQueue=new J.vpe,this.removeExperimentFromQueue=new J.vpe,this.moveExperimentInQueue=new J.vpe,this.experimentsCols=[{header:"",class:"col-4"},{header:"",class:"col-20"}],this.workersCols=[{header:"Name",class:"col-9"},{header:"IP",class:"col-6"},{header:"Currently Executing",class:"col-9"}]}set selectedQueue(e){this._selectedQueue=(0,je.cloneDeep)(e)}get selectedQueue(){return this._selectedQueue}clickHandler(e){2!=e.button&&(this.menuOpen=!1)}get routerTab(){return new URL(window.location.href).searchParams.get("tab")}ngOnInit(){this.activeTab="workers"===this.routerTab?"workers":"experiments"}findQueueById(e){return this.queues.find(t=>t.id===e)}deselectQueueClicked(){this.deselectQueue.emit()}experimentDropped(e){this.moveExperimentInQueue.emit({task:this.selectedQueue.entries[e.previousIndex].task.id,count:e.currentIndex-e.previousIndex}),(0,cn.bA)(this.selectedQueue.entries,e.previousIndex,e.currentIndex)}openContextMenu(e,t){this.menuSelectedExperiment=t,e.preventDefault(),this.menuOpen=!1,setTimeout(()=>{this.menuPosition={x:e.clientX,y:e.clientY},this.menuOpen=!0,this.changeDetector.detectChanges()},0)}moveToTop(){this.moveExperimentToTopOfQueue.emit(this.menuSelectedExperiment)}moveToBottom(){this.moveExperimentToBottomOfQueue.emit(this.menuSelectedExperiment)}moveToQueue(){this.enqueuePopup()}removeFromQueue(){this.removeExperimentFromQueue.emit(this.menuSelectedExperiment)}enqueuePopup(){this.dialog.open(pn.e,{data:{}}).afterClosed().subscribe(e=>{e&&e.confirmed&&(this.moveExperimentToOtherQueue.emit({queue:e.queue,task:this.menuSelectedExperiment}),this.blTaskService.setPreviouslyUsedQueue(e.queue))})}}return e.\u0275fac=function(t){return new(t||e)(J.Y36(J.sBO),J.Y36(dn.O),J.Y36(F.uw))},e.\u0275cmp=J.Xpm({type:e,selectors:[["sm-queue-info"]],hostBindings:function(e,t){1&e&&J.NdJ("click",function(e){return t.clickHandler(e)},!1,J.evT)},inputs:{selectedQueue:"selectedQueue",queues:"queues"},outputs:{deselectQueue:"deselectQueue",moveExperimentToTopOfQueue:"moveExperimentToTopOfQueue",moveExperimentToBottomOfQueue:"moveExperimentToBottomOfQueue",moveExperimentToOtherQueue:"moveExperimentToOtherQueue",removeExperimentFromQueue:"removeExperimentFromQueue",moveExperimentInQueue:"moveExperimentInQueue"},decls:23,vars:7,consts:[[1,"d-flex","justify-content-center","tabs-container"],["header","Experiments",3,"active","click"],["header","Workers",3,"active","click"],[1,"pull-right","pointer","tabs-x",3,"click"],[1,"al-icon","al-ico-dialog-x","sm-md"],["class","d-flex align-items-center justify-content-center p-4",4,"ngIf"],["noDataMessage"," ",3,"cols","rowsData",4,"ngIf"],["buttonClass","al-icon sm-md al-ico-bars-menu al-color light-grey-blue","smMenuClass","experiments-in-queue-list","panelClasses","dark",3,"position","header","showCart","showOverlay","showButton","openOnInit","onMenuClosed",4,"ngIf"],["noDataMessage"," ",3,"cols","rowsData","enableDragAndDrop","entryDropped",4,"ngIf"],[1,"d-flex","align-items-center","justify-content-center","p-4"],["noDataMessage"," ",3,"cols","rowsData"],[1,"ml-2","flex-column","link",3,"routerLink","queryParams"],[1,"flex-column"],[3,"href"],["buttonClass","al-icon sm-md al-ico-bars-menu al-color light-grey-blue","smMenuClass","experiments-in-queue-list","panelClasses","dark",3,"position","header","showCart","showOverlay","showButton","openOnInit","onMenuClosed"],["itemLabel","Move to top","iconClass","al-icon al-ico-arrow-to-top al-color light-periwinkle-two sm mr-2",3,"disabled","itemClicked"],["itemLabel","Move to bottom","iconClass","sm mr-2 al-icon al-ico-arrow-to-bottom al-color light-periwinkle-two",3,"disabled","itemClicked"],["itemLabel","Move to queue...","iconClass","sm mr-2 al-icon al-ico-arrow-from-left al-color light-periwinkle-two",3,"disabled","itemClicked"],["itemLabel","Remove from queue","iconClass","fas fa-trash",3,"disabled","iconFontSize","itemClicked"],["noDataMessage"," ",3,"cols","rowsData","enableDragAndDrop","entryDropped"],[1,"column","ml-3"],[1,"fas","fa-th","drag-grid"],[1,"column"],[1,"al-icon","al-ico-dots-v-menu","sm-md","pointer","p-2",3,"click"]],template:function(e,t){1&e&&(J.TgZ(0,"div",0),J._uU(1,"\n  "),J.TgZ(2,"sm-navbar-item",1),J.NdJ("click",function(){return t.activeTab="experiments"}),J.qZA(),J._uU(3,"\n  "),J.TgZ(4,"sm-navbar-item",2),J.NdJ("click",function(){return t.activeTab="workers"}),J._uU(5,"\n  "),J.qZA(),J._uU(6,"\n  "),J.TgZ(7,"div",3),J.NdJ("click",function(){return t.deselectQueueClicked()}),J._uU(8,"\n    "),J._UZ(9,"i",4),J._uU(10,"\n  "),J.qZA(),J._uU(11,"\n"),J.qZA(),J._uU(12,"\n\n"),J.YNc(13,hn,2,0,"div",5),J._uU(14,"\n"),J.YNc(15,mn,2,0,"div",5),J._uU(16,"\n"),J.YNc(17,Un,4,2,"sm-simple-table-2",6),J._uU(18,"\n\n"),J.YNc(19,vn,14,10,"sm-menu",7),J._uU(20,"\n\n"),J.YNc(21,En,4,3,"sm-simple-table-2",8),J._uU(22,"\n")),2&e&&(J.xp6(2),J.Q6J("active","experiments"===t.activeTab),J.xp6(2),J.Q6J("active","workers"===t.activeTab),J.xp6(9),J.Q6J("ngIf","experiments"===t.activeTab&&0===(null==t.selectedQueue||null==t.selectedQueue.entries?null:t.selectedQueue.entries.length)),J.xp6(2),J.Q6J("ngIf","workers"===t.activeTab&&0===(null==t.selectedQueue||null==t.selectedQueue.workers?null:t.selectedQueue.workers.length)),J.xp6(2),J.Q6J("ngIf","workers"===t.activeTab&&(null==t.selectedQueue||null==t.selectedQueue.workers?null:t.selectedQueue.workers.length)>0),J.xp6(2),J.Q6J("ngIf",t.menuOpen),J.xp6(2),J.Q6J("ngIf","experiments"===t.activeTab))},directives:[X.f,i.O5,vt.g,r.yS,Ft.M,Jt.q],styles:["[_nghost-%COMP%]     .table-row{background-color:#1a1e2c!important;border-bottom:1px solid #303443!important}[_nghost-%COMP%]     .row.headers{border-bottom:none!important}[_nghost-%COMP%]   .tabs-container[_ngcontent-%COMP%]{position:relative;background-color:#1a1e2c;border-bottom:1px solid #303443;margin:12px 0 0;height:38px}[_nghost-%COMP%]   .tabs-container[_ngcontent-%COMP%]     .navbar-item{height:100%;padding:0 15px;margin:0 1px}[_nghost-%COMP%]   .pull-right[_ngcontent-%COMP%]{position:absolute;right:24px;top:0}[_nghost-%COMP%]   sm-navbar-item[disabled][_ngcontent-%COMP%]{pointer-events:none}[_nghost-%COMP%]   sm-navbar-item[disabled][_ngcontent-%COMP%]   .bottom[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]     .drag-grid{color:#191e2c;transition:color .5s}[_nghost-%COMP%]     .table-row:hover .drag-grid{transition:color .5s;color:#39405f}[_nghost-%COMP%]   .column[_ngcontent-%COMP%]{width:36px;padding:0 8px}[_nghost-%COMP%]   .flex-column[_ngcontent-%COMP%]{flex:1;padding:0 8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}"]}),e})(),wn=(()=>{class e{constructor(e,t,n,s){this.store=e,this.router=t,this.route=n,this.dialog=s,this.queues$=this.store.select(Ce),this.queuesTasks$=this.store.select(ye),this.selectedQueue$=this.store.select(qe),this.tableSortFields$=this.store.select(Ze)}get routerQueueId(){return new URL(window.location.href).searchParams.get("id")}ngOnInit(){this.store.dispatch(l()),this.queues$.pipe((0,Le.M)(this.selectedQueue$),(0,o.h)(([e,t])=>e&&(null==t?void 0:t.id)!==this.routerQueueId),(0,a.q)(1)).subscribe(([e])=>{const t=e.find(e=>e.id===this.routerQueueId);this.selectQueue(t)})}sortedChanged(e){this.store.dispatch(d({colId:e.colId,isShift:e.isShift}))}selectQueue(e){this.router.navigate([],{relativeTo:this.route,queryParams:{id:null==e?void 0:e.id},queryParamsHandling:"merge"}),this.store.dispatch(h({queue:e}))}deleteQueue(e){this.store.dispatch(f({queue:e}))}renameQueue(e){this.createQueueDialog=this.dialog.open($,{data:e}),this.createQueueDialog.afterClosed().pipe((0,o.h)(e=>!!e),(0,a.q)(1)).subscribe(()=>{this.store.dispatch(l())})}moveExperimentToBottomOfQueue(e){this.store.dispatch(U({task:e.id}))}moveExperimentToTopOfQueue(e){this.store.dispatch(v({task:e.id}))}removeExperimentFromQueue(e){this.store.dispatch(E({task:e.id}))}moveExperimentToOtherQueue(e){this.store.dispatch(T({task:e.task.id,queue:e.queue.id}))}moveExperimentInQueue({task:e,count:t}){this.store.dispatch(x({task:e,count:t}))}}return e.\u0275fac=function(t){return new(t||e)(J.Y36(u.yh),J.Y36(r.F0),J.Y36(r.gz),J.Y36(F.uw))},e.\u0275cmp=J.Xpm({type:e,selectors:[["sm-queues"]],decls:25,vars:26,consts:[[3,"queue"],[1,"flex-grow-1"],[3,"size"],[1,"mt-2",3,"queues","selectedQueue","tableSortFields","tableSortOrder","sortedChanged","deleteQueue","renameQueue","queueSelected"],[3,"size","visible"],[3,"selectedQueue","queues","moveExperimentToTopOfQueue","moveExperimentToBottomOfQueue","removeExperimentFromQueue","moveExperimentToOtherQueue","moveExperimentInQueue","deselectQueue"]],template:function(e,t){1&e&&(J._UZ(0,"sm-queue-stats",0),J.ALo(1,"async"),J._uU(2,"\n"),J.TgZ(3,"as-split",1),J._uU(4,"\n  "),J.TgZ(5,"as-split-area",2),J._uU(6,"\n    "),J.TgZ(7,"sm-queues-table",3),J.NdJ("sortedChanged",function(e){return t.sortedChanged(e)})("deleteQueue",function(e){return t.deleteQueue(e)})("renameQueue",function(e){return t.renameQueue(e)})("queueSelected",function(e){return t.selectQueue(e)}),J.ALo(8,"async"),J.ALo(9,"async"),J.ALo(10,"async"),J.ALo(11,"async"),J._uU(12,"\n    "),J.qZA(),J._uU(13,"\n  "),J.qZA(),J._uU(14,"\n  "),J.TgZ(15,"as-split-area",4),J.ALo(16,"async"),J._uU(17,"\n    "),J.TgZ(18,"sm-queue-info",5),J.NdJ("moveExperimentToTopOfQueue",function(e){return t.moveExperimentToTopOfQueue(e)})("moveExperimentToBottomOfQueue",function(e){return t.moveExperimentToBottomOfQueue(e)})("removeExperimentFromQueue",function(e){return t.removeExperimentFromQueue(e)})("moveExperimentToOtherQueue",function(e){return t.moveExperimentToOtherQueue(e)})("moveExperimentInQueue",function(e){return t.moveExperimentInQueue(e)})("deselectQueue",function(){return t.selectQueue(null)}),J.ALo(19,"async"),J.ALo(20,"async"),J._uU(21,"\n    "),J.qZA(),J._uU(22,"\n  "),J.qZA(),J._uU(23,"\n"),J.qZA(),J._uU(24,"\n")),2&e&&(J.Q6J("queue",J.lcZ(1,10,t.selectedQueue$)),J.xp6(5),J.Q6J("size",50),J.xp6(2),J.Q6J("queues",J.lcZ(8,12,t.queues$))("selectedQueue",J.lcZ(9,14,t.selectedQueue$))("tableSortFields",J.lcZ(10,16,t.tableSortFields$))("tableSortOrder",J.lcZ(11,18,t.tableSortOrder$)),J.xp6(8),J.Q6J("size",50)("visible",!!J.lcZ(16,20,t.selectedQueue$)),J.xp6(3),J.Q6J("selectedQueue",J.lcZ(19,22,t.selectedQueue$))("queues",J.lcZ(20,24,t.queues$)))},directives:[Dt,st.Mq,st.zE,ln,Tn],pipes:[i.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:calc(100% - 66px)}[_nghost-%COMP%]   as-split[_ngcontent-%COMP%]{height:calc(100% - 364px);min-height:180px}"]}),e})();var bn=n(81134);let kn=(()=>{class e{resolve(){return(0,bn.of)(!0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=J.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const On=[{path:"",component:se,resolve:{queuesManager:kn},children:[{path:"",redirectTo:"workers"},{path:"workers",component:At},{path:"queues",component:wn,resolve:{queuesManager:kn}}]}];let Qn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=J.oAB({type:e}),e.\u0275inj=J.cJS({imports:[[r.Bz.forChild(On)],r.Bz]}),e})();var Cn=n(96108),qn=n(85409),yn=n(79902),Mn=n(85816),An=n(18293),Zn=n(2976),Sn=n(26740),Pn=n(9312),In=n(10255);const Nn={get:function(e,t){return e.hasOwnProperty(t)||(e[t]=Math.max(...Object.values(e),0)+1),e[t]}};function Dn(e,t,n,s,i,r){const o=new Proxy({},Nn);let a;e?(e.forEach(e=>o[e.topicID]=e.topic),a=e.slice()):a=[];const u=[...new Set((0,je.flattenDeep)(t.map(e=>e.metrics?e.metrics.map(e=>e.dates):[])))],l=t.length>1;return t.forEach(e=>{const t=e[i];s.forEach(s=>{const i=e.metrics.find(e=>e.metric===s.key);if(!i)return;const c=i.dates,d=i.metric;i.stats.forEach(e=>{const s=e.aggregation,i=`${t} ${d} ${s}`,p=`${r[d].title} (${s})${l&&t?" for "+t:""}`;let h=a.find(e=>e.topicID===i);h||(h={topicName:p,topicID:i,topic:o[i],dates:[]},a.push(h));const m=u.filter(e=>{if(0===h.dates.length)return!0;const t=new Date(e).toISOString();return h.dates.findIndex(e=>e.date===t)<0}).map(t=>{const n=c.indexOf(t);return{date:new Date(t).toISOString(),value:n>-1?e.values[n]*r[d].multiply:null}});h.dates.push(...m),h.dates=h.dates.slice(Math.max(h.dates.length-n,0))})}),s.forEach(e=>{if(!a.find(t=>t.topicID.indexOf(e.key)>-1)){const n=`${t} ${e.key} avg`;a.push({topicName:`${r[e.key].title} (avg) ${l&&t?"for "+t:""}`,topicID:n,topic:o[n],dates:[]})}})}),a}function Rn(e){const t=e[0].dates;null===t.slice(-1)[0].value&&t.splice(-1,1),null===t[0].value&&t.splice(0,1)}function Fn(e,t,n){e[0].dates.splice(0,0,{date:new Date(1e3*t).toISOString(),value:null}),e[0].dates.push({date:new Date(1e3*n).toISOString(),value:null})}var Jn=n(37732);let Wn=(()=>{class e{constructor(e,t,n){this.actions=e,this.workersApi=t,this.store=n,this.getWorkers$=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(re),(0,Le.M)(this.store.select(Ne),this.store.select(De)),(0,yn.w)(([e,t,n])=>this.workersApi.workersGetAll({}).pipe((0,Mn.zg)(s=>{const i=this.transformAndSortWorkers(n,s.workers),r=[oe({workers:i}),(0,In.tM)(e.type)];return t&&r.push(ue({worker:i.find(e=>e.id===t.id)})),r}),(0,An.K)(t=>[(0,Pn.Z)(t),(0,In.tM)(e.type)]))))),this.sortWorkers$=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(ce),(0,Le.M)(this.store.select(De),this.store.select(Pe)),(0,Mn.zg)(([,e,t])=>[oe({workers:this.transformAndSortWorkers(e,t)})]))),this.getStats$=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(re),(0,Le.M)(this.store.select(Ie),this.store.select(Fe),this.store.select(Re),this.store.select(Ne)),(0,yn.w)(([e,t,n,s,i])=>{const r=Math.floor((new Date).getTime()/1e3),o=s.split(";").map(e=>({key:e})),a=parseInt(n,10),u=Math.max(Math.floor(a/e.maxPoints),i?10:40);let l;if(t=(0,je.cloneDeep)(t),Array.isArray(t)&&t.some(e=>e.dates.length>1)?(Rn(t),l=r-function(e){let t=0;return e.forEach(e=>{const n=e.dates;if(n){const e=(0,je.getOr)(0,"date",(0,je.last)(n)),s=Math.floor(new Date(e).getTime()/1e3);t=Math.max(t,s)}}),t}(t)+u):l=a,i){const n=((e,t,n,s)=>{const i=Math.floor((new Date).getTime()/1e3);return{from_date:i-n,to_date:i,worker_ids:e?[e]:null,items:(0,je.castArray)(t),interval:s}})(i.name,o,l,u);return this.workersApi.workersGetStats(n).pipe((0,Mn.zg)(n=>(n&&(n=Dn(t,n.workers,e.maxPoints,o,"worker",_e),Array.isArray(n)&&n.some(e=>e.dates.length>0)&&Fn(n,r-a,r)),[de({data:n})])),(0,An.K)(e=>[(0,Pn.Z)(e),de({data:[]}),(0,In.Hz)(Zn.Hh.WARN,"Failed to fetching activity worker statistics")]))}return this.workersApi.workersGetActivityReport({from_date:r-l,to_date:r,interval:u}).pipe((0,Mn.zg)(n=>{let s=null;return n&&(s=Dn(t,[{activity:"",metrics:[{metric:"total",dates:n.total.dates,stats:[{aggregation:"count",values:n.total.counts}]},{metric:"active",dates:n.active.dates,stats:[{aggregation:"count",values:n.active.counts}]}]}],e.maxPoints,[{key:"active"},{key:"total"}],"activity",{total:{title:"Total Workers",multiply:1},active:{title:"Active Workers",multiply:1}})),Array.isArray(s)&&s.some(e=>e.dates.length>0)&&Fn(s,r-a,r),[de({data:s}),we()]}),(0,An.K)(e=>[(0,Pn.Z)(e),de({data:[]}),Te()]))}))),this.tableSortChange=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(le),(0,Le.M)(this.store.select(De)),(0,yn.w)(([e,t])=>{const n=(0,Jn.xc)(t,e.colId,e.isShift);return[ce({orders:n})]})))}transformAndSortWorkers(e,t){t=t.map(e=>Object.assign(Object.assign({},e),{id:e.key||e.id,name:e.id}));const n=e.map(e=>e.field),s=e.map(e=>e.order>0?"asc":"desc");return(0,je.orderBy)(n,s,t)}}return e.\u0275fac=function(t){return new(t||e)(J.LFG(qn.eX),J.LFG(Sn.z),J.LFG(u.yh))},e.\u0275prov=J.Yz7({token:e,factory:e.\u0275fac}),e})();var Ln=n(33927),Hn=n(14921),jn=n(33365),Bn=n(1666),Yn=n(2158);let zn=(()=>{class e{constructor(e,t,n,s){this.actions=e,this.queuesApi=t,this.tasksApi=n,this.store=s,this.activeLoader=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(l,m),(0,Ln.U)(e=>(0,In.oR)(e.type)))),this.getQueues=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(l,p),(0,Le.M)(this.store.select(Ze)),(0,yn.w)(([e,t])=>this.queuesApi.queuesGetAllEx({only_fields:["*","entries.task.name"],order_by:(0,Yn.Ke)(t)}).pipe((0,Mn.zg)(n=>[c({queues:this.sortQueues(t,n.queues)}),(0,In.tM)(e.type)]),(0,An.K)(t=>[(0,In.tM)(e.type),(0,Pn.Z)(t)]))))),this.getSelectedQueue=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(h),(0,o.h)(e=>!!e.queue),(0,Hn.b)(e=>this.store.dispatch((0,In.oR)(e.type))),(0,yn.w)(e=>this.queuesApi.queuesGetAllEx({id:[e.queue.id],only_fields:["*","entries.task.name"]}).pipe((0,Mn.zg)(t=>[g({queue:t.queues[0]}),_({queue:t.queues[0]}),(0,In.tM)(e.type)]),(0,An.K)(t=>[(0,In.tM)(e.type),(0,Pn.Z)(t)]))))),this.refreshSelectedQueue=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(m),(0,Le.M)(this.store.select(qe)),(0,yn.w)(([e,t])=>this.queuesApi.queuesGetAllEx({id:[t.id],only_fields:["*","entries.task.name"]}).pipe((0,Mn.zg)(t=>[g({queue:t.queues[0]}),_({queue:t.queues[0]}),(0,In.tM)(e.type)]),(0,An.K)(t=>[(0,In.tM)(e.type),(0,Pn.Z)(t)]))))),this.deleteQueues=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(f),(0,yn.w)(e=>this.queuesApi.queuesDelete({queue:e.queue.id}).pipe((0,Mn.zg)(()=>[l(),h({})]),(0,An.K)(t=>[(0,In.tM)(e.type),(0,Pn.Z)(t),(0,In.Hz)(Zn.Hh.ERROR,"Delete Queue failed")]))))),this.moveExperimentToTopOfQueue=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(v),(0,Le.M)(this.store.select(qe)),(0,yn.w)(([e,t])=>this.queuesApi.queuesMoveTaskToFront({queue:t.id,task:e.task}).pipe((0,Mn.zg)(()=>[m()]),(0,An.K)(t=>[(0,In.tM)(e.type),(0,Pn.Z)(t),(0,In.Hz)(Zn.Hh.ERROR,"Move Experiment failed")]))))),this.moveExperimentToBottomOfQueue=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(U),(0,Le.M)(this.store.select(qe)),(0,yn.w)(([e,t])=>this.queuesApi.queuesMoveTaskToBack({queue:t.id,task:e.task}).pipe((0,Mn.zg)(()=>[m()]),(0,An.K)(t=>[(0,In.tM)(e.type),(0,Pn.Z)(t),(0,In.Hz)(Zn.Hh.ERROR,"Move Experiment failed")]))))),this.moveExperimentInQueue=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(x),(0,Le.M)(this.store.select(qe)),(0,yn.w)(([e,t])=>this.queuesApi.queuesMoveTaskBackward({queue:t.id,task:e.task,count:e.count}).pipe((0,Mn.zg)(()=>[m()]),(0,An.K)(t=>[m(),(0,In.tM)(e.type),(0,Pn.Z)(t),(0,In.Hz)(Zn.Hh.ERROR,"Move Queue failed")]))))),this.removeExperimentFromQueue=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(E),(0,yn.w)(e=>this.tasksApi.tasksDequeue({task:e.task}).pipe((0,Mn.zg)(()=>[m()]),(0,An.K)(t=>[(0,In.tM)(e.type),(0,Pn.Z)(t),(0,In.Hz)(Zn.Hh.ERROR,"Remove Queue failed")]))))),this.moveExperimentToOtherQueue=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(T),(0,Le.M)(this.store.select(qe)),(0,yn.w)(([e,t])=>this.queuesApi.queuesRemoveTask({queue:t.id,task:e.task}).pipe((0,Mn.zg)(()=>[w({task:e.task,queue:e.queue})]),(0,An.K)(t=>[(0,In.tM)(e.type),(0,Pn.Z)(t),(0,In.Hz)(Zn.Hh.ERROR,"Move Queue to other queue failed")]))))),this.addExperimentToQueue=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(w),(0,yn.w)(e=>this.queuesApi.queuesAddTask({queue:e.queue,task:e.task}).pipe((0,Mn.zg)(()=>[m(),l()]),(0,An.K)(t=>[(0,In.tM)(e.type),(0,Pn.Z)(t),(0,In.Hz)(Zn.Hh.ERROR,"Add experiment to queue failed")]))))),this.getStats$=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(b),(0,Le.M)(this.store.select(Me),this.store.select(qe),this.store.select(Ae)),(0,yn.w)(([e,t,n,s])=>{const i=Math.floor((new Date).getTime()/1e3),r=parseInt(s,10),o=Math.max(Math.floor(r/e.maxPoints),n?10:40);return this.queuesApi.queuesGetQueueMetrics({from_date:i-r,to_date:i,queue_ids:n?[n.id]:void 0,interval:o}).pipe((0,Mn.zg)(n=>{let s={wait:null,length:null};if(t=(0,je.cloneDeep)(t),n&&n.queues){let o;Array.isArray(t.wait)&&t.wait.some(e=>e.dates.length>1)&&Rn(t.wait),Array.isArray(t.length)&&t.length.some(e=>e.dates.length>1)&&Rn(t.length),o=n.queues.length?n.queues[0]:{dates:[],avg_waiting_times:[],queue_lengths:[]};const a=[{length:"",metrics:[{metric:"queueLen",dates:o.dates,stats:[{aggregation:"count",values:o.queue_lengths}]}]}];s={wait:Dn(t.wait,[{wait:"",metrics:[{metric:"queueAvgWait",dates:o.dates,stats:[{aggregation:"seconds",values:o.avg_waiting_times}]}]}],e.maxPoints,[{key:"queueAvgWait"}],"wait",{queueAvgWait:{title:"Queue Average Wait Time",multiply:1}}),length:Dn(t.length,a,e.maxPoints,[{key:"queueLen"}],"length",{queueLen:{title:"Queues Average Length",multiply:1}})},Array.isArray(s.wait)&&s.wait.some(e=>e.dates.length>0)&&Fn(s.wait,i-r,i),Array.isArray(s.length)&&s.length.some(e=>e.dates.length>0)&&Fn(s.length,i-r,i)}return[(0,In.tM)(e.type),k({data:s}),we()]}),(0,An.K)(t=>[(0,In.tM)(e.type),k({data:{wait:[],length:[]}}),(0,Pn.Z)(t),Te()]))}))),this.tableSortChange=(0,qn.GW)(()=>this.actions.pipe((0,qn.l4)(d),(0,Le.M)(this.store.select(Ze)),(0,yn.w)(([e,t])=>{const n=(0,Jn.xc)(t,e.colId,e.isShift);return[p({orders:n})]})))}sortQueues(e,t){const n=e.map(e=>e.field),s=e.map(e=>e.order>0?"asc":"desc");return(0,je.orderBy)(n,s,t)}}return e.\u0275fac=function(t){return new(t||e)(J.LFG(qn.eX),J.LFG(jn.p),J.LFG(Bn.P),J.LFG(u.yh))},e.\u0275prov=J.Yz7({token:e,factory:e.\u0275fac}),e})();var Gn=n(11875),Kn=n(44466),$n=n(21927),Xn=n(3786);class Vn{constructor(e,t,n){this.actions=e,this.queuesApiService=t,this.router=n,this.activeLoader=this.actions.pipe((0,qn.l4)(C.CREATE_NEW_QUEUE),(0,Ln.U)(e=>(0,In.oR)(e.type))),this.createQueue=this.actions.pipe((0,qn.l4)(C.CREATE_NEW_QUEUE),(0,Mn.zg)(e=>this.queuesApiService.queuesCreate(e.payload).pipe((0,Mn.zg)(t=>[(0,In.tM)(e.type),new S("success"),(0,In.Hz)(Zn.Hh.SUCCESS,"Queue Created Successfully")]),(0,An.K)(t=>[(0,In.tM)(e.type),(0,Pn.Z)(t),(0,In.Hz)(Zn.Hh.ERROR,"Queue Created Failed"),new S("failed")])))),this.updateQueue=this.actions.pipe((0,qn.l4)(C.UPDATE_QUEUE),(0,Mn.zg)(e=>this.queuesApiService.queuesUpdate(e.payload).pipe((0,Mn.zg)(t=>[(0,In.tM)(e.type),new S("success"),(0,In.Hz)(Zn.Hh.SUCCESS,"Queue Updated Successfully")]),(0,An.K)(t=>[(0,In.tM)(e.type),(0,Pn.Z)(t),(0,In.Hz)(Zn.Hh.ERROR,"Queue Created Failed"),new S("failed")])))),this.getAllQueues=this.actions.pipe((0,qn.l4)(C.GET_QUEUES),(0,yn.w)(e=>this.queuesApiService.queuesGetAllEx({}).pipe((0,Mn.zg)(e=>[new y(e.queues)]),(0,An.K)(e=>[(0,Pn.Z)(e)]))))}}Vn.\u0275fac=function(e){return new(e||Vn)(J.LFG(qn.eX),J.LFG(jn.p),J.LFG(r.F0))},Vn.\u0275prov=J.Yz7({token:Vn,factory:Vn.\u0275fac}),(0,Xn.gn)([(0,qn.Qm)(),(0,Xn.w6)("design:type",Object)],Vn.prototype,"activeLoader",void 0),(0,Xn.gn)([(0,qn.Qm)(),(0,Xn.w6)("design:type",Object)],Vn.prototype,"createQueue",void 0),(0,Xn.gn)([(0,qn.Qm)(),(0,Xn.w6)("design:type",Object)],Vn.prototype,"updateQueue",void 0),(0,Xn.gn)([(0,qn.Qm)(),(0,Xn.w6)("design:type",Object)],Vn.prototype,"getAllQueues",void 0);var es=n(86411),ts=n(43581);let ns=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=J.oAB({type:e}),e.\u0275inj=J.cJS({imports:[[es.Q,i.ez,s.u5,s.UX,ts.T,u.Aw.forFeature("queueCreateDialog",R),qn.sQ.forFeature([Vn])]]}),e})();var ss=n(23217);let is=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=J.oAB({type:e}),e.\u0275inj=J.cJS({imports:[[$n.F,Gn.D,i.ez,Qn,Kn.m,Cn.u,ns,ss.z,u.Aw.forFeature("workersAndQueues",ke),qn.sQ.forFeature([Wn,zn]),st.fX,s.u5]]}),e})()}}]);
//# sourceMappingURL=175-es2015.9e9c92c4c5fdb31d2804.js.map